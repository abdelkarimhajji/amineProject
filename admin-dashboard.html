<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard â€” Silent Lease</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --admin-sidebar: #0c1222;
      --admin-sidebar-hover: rgba(255,255,255,0.07);
      --admin-sidebar-active: rgba(13,148,136,0.18);
      --admin-sidebar-border: rgba(255,255,255,0.06);
      --admin-surface: #ffffff;
      --admin-bg: #f0f4f8;
      --admin-text: #0f172a;
      --admin-text-muted: #64748b;
      --admin-border: #e2e8f0;
      --admin-accent: #0d9488;
      --admin-accent-hover: #0f766e;
      --admin-accent-light: rgba(13,148,136,0.08);
      --admin-primary: #1e293b;
      --admin-danger: #dc2626;
      --admin-danger-hover: #b91c1c;
      --admin-radius: 12px;
      --admin-radius-sm: 8px;
      --admin-radius-lg: 16px;
      --admin-shadow: 0 1px 2px rgba(0,0,0,0.04), 0 2px 8px rgba(0,0,0,0.04);
      --admin-shadow-hover: 0 4px 12px rgba(0,0,0,0.06), 0 8px 24px rgba(0,0,0,0.06);
      --admin-shadow-lg: 0 12px 48px -12px rgba(0,0,0,0.12);
      --admin-transition: 0.2s ease;
    }
    body { font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif; -webkit-font-smoothing: antialiased; color: var(--admin-text); }
    .admin-wrap { display: flex; min-height: 100vh; background: var(--admin-bg); }
    .admin-sidebar {
      width: 280px; background: var(--admin-sidebar); color: rgba(255,255,255,0.92);
      flex-shrink: 0; padding: 1.5rem 0; border-right: 1px solid var(--admin-sidebar-border);
      position: fixed; left: 0; top: 0; height: 100vh; overflow-y: auto;
      box-shadow: 4px 0 24px rgba(0,0,0,0.06);
    }
    .admin-sidebar__logo {
      padding: 0 1.5rem 1.75rem; margin-bottom: 0.5rem; border-bottom: 1px solid var(--admin-sidebar-border);
      font-size: 1.2rem; font-weight: 700; color: #fff; letter-spacing: -0.02em;
      display: flex; align-items: center; gap: 0.75rem;
    }
    .admin-sidebar__logo i { color: var(--admin-accent); font-size: 1.35rem; opacity: 0.95; }
    .admin-sidebar__section {
      font-size: 0.6875rem; text-transform: uppercase; letter-spacing: 0.1em;
      color: rgba(255,255,255,0.4); padding: 1rem 1.5rem 0.5rem;
    }
    .admin-sidebar__link {
      display: flex; align-items: center; gap: 0.75rem; padding: 0.7rem 1.25rem; margin: 0 0.75rem 0.2rem;
      border-radius: var(--admin-radius-sm); color: rgba(255,255,255,0.82);
      text-decoration: none; font-weight: 500; font-size: 0.9375rem;
      transition: background var(--admin-transition), color var(--admin-transition), padding-left 0.2s ease;
    }
    .admin-sidebar__link:hover { background: var(--admin-sidebar-hover); color: #fff; padding-left: 1.5rem; }
    .admin-sidebar__link.active { background: var(--admin-sidebar-active); color: #fff; box-shadow: inset 3px 0 0 var(--admin-accent); }
    .admin-sidebar__link i { width: 22px; text-align: center; opacity: 0.9; font-size: 1rem; }
    .admin-burger {
      display: none; align-items: center; justify-content: center; width: 44px; height: 44px;
      border: none; border-radius: var(--admin-radius-sm); background: var(--admin-bg);
      color: var(--admin-text); cursor: pointer; margin-right: 0.75rem;
      transition: background var(--admin-transition);
    }
    .admin-burger:hover { background: var(--admin-border); }
    .admin-burger i { font-size: 1.25rem; }
    .admin-sidebar__close {
      display: none; position: absolute; top: 1rem; right: 1rem;
      width: 40px; height: 40px; align-items: center; justify-content: center;
      border: none; border-radius: var(--admin-radius-sm); background: var(--admin-sidebar-hover);
      color: rgba(255,255,255,0.9); cursor: pointer; transition: background var(--admin-transition);
    }
    .admin-sidebar__close:hover { background: rgba(255,255,255,0.12); }
    .admin-main { flex: 1; display: flex; flex-direction: column; min-width: 0; margin-left: 280px; }
    .admin-topbar {
      background: var(--admin-surface); padding: 1.25rem 1.75rem;
      box-shadow: var(--admin-shadow); border-bottom: 1px solid var(--admin-border);
      display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;
    }
    .admin-topbar__title { font-size: 1.4rem; font-weight: 700; color: var(--admin-text); margin: 0; letter-spacing: -0.025em; }
    .admin-topbar__breadcrumb { font-size: 0.8125rem; color: var(--admin-text-muted); margin-top: 0.2rem; }
    .admin-topbar__actions { display: flex; align-items: center; gap: 0.5rem; }
    .admin-topbar__btn {
      padding: 0.5rem 1rem; border-radius: var(--admin-radius-sm); border: 1px solid var(--admin-border);
      cursor: pointer; font-size: 0.875rem; font-weight: 500; font-family: inherit;
      display: inline-flex; align-items: center; gap: 0.5rem; text-decoration: none;
      color: var(--admin-text-muted); background: var(--admin-surface);
      transition: background var(--admin-transition), color var(--admin-transition), border-color var(--admin-transition);
    }
    .admin-topbar__btn:hover { background: var(--admin-bg); color: var(--admin-text); border-color: #cbd5e1; }
    .admin-topbar__btn--logout { color: var(--admin-danger); border-color: transparent; background: rgba(220,38,38,0.08); }
    .admin-topbar__btn--logout:hover { background: rgba(220,38,38,0.14); color: var(--admin-danger-hover); }
    .admin-topbar__profile {
      display: flex; align-items: center; gap: 0.875rem;
      padding: 0.35rem 0.5rem 0.35rem 0.75rem; border-radius: var(--admin-radius);
      border: 1px solid var(--admin-border); background: var(--admin-surface);
      margin-right: 0.25rem;
    }
    .admin-topbar__profile-avatar {
      width: 42px; height: 42px; border-radius: 50%;
      background: linear-gradient(135deg, var(--admin-accent) 0%, #0f766e 100%);
      color: #fff; font-weight: 700; font-size: 1rem;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0; letter-spacing: -0.02em;
    }
    .admin-topbar__profile-info { min-width: 0; }
    .admin-topbar__profile-name { font-size: 0.9375rem; font-weight: 600; color: var(--admin-text); margin: 0; line-height: 1.3; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .admin-topbar__profile-role { font-size: 0.75rem; color: var(--admin-text-muted); margin-top: 0.125rem; text-transform: uppercase; letter-spacing: 0.04em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .admin-topbar__profile-settings {
      width: 36px; height: 36px; border-radius: var(--admin-radius-sm); border: 1px solid var(--admin-border);
      display: flex; align-items: center; justify-content: center; color: var(--admin-text-muted);
      text-decoration: none; transition: background var(--admin-transition), color var(--admin-transition);
    }
    .admin-topbar__profile-settings:hover { background: var(--admin-bg); color: var(--admin-accent); }
    .admin-topbar__profile { cursor: pointer; position: relative; user-select: none; }
    .admin-topbar__profile-chevron { margin-left: 0.25rem; font-size: 0.625rem; color: var(--admin-text-muted); transition: transform 0.2s ease; }
    .admin-topbar__profile.is-open .admin-topbar__profile-chevron { transform: rotate(180deg); }
    .admin-topbar__profile-dropdown {
      position: absolute; top: 100%; right: 0; margin-top: 0.5rem; min-width: 212px;
      background: var(--admin-surface); border: 1px solid var(--admin-border); border-radius: var(--admin-radius);
      box-shadow: var(--admin-shadow-lg); z-index: 100; display: none;
      padding: 0.5rem; list-style: none; margin: 0;
    }
    .admin-topbar__profile.is-open .admin-topbar__profile-dropdown { display: block; }
    .admin-topbar__profile-dropdown li { margin: 0; }
    .admin-topbar__profile-dropdown a,
    .admin-topbar__profile-dropdown button {
      width: 100%; text-align: left; padding: 0.625rem 0.875rem; border-radius: var(--admin-radius-sm);
      border: none; background: none; cursor: pointer; font-size: 0.875rem; font-family: inherit;
      color: var(--admin-text); text-decoration: none; display: flex; align-items: center; gap: 0.5rem;
      transition: background var(--admin-transition);
    }
    .admin-topbar__profile-dropdown a:hover,
    .admin-topbar__profile-dropdown button:hover { background: var(--admin-bg); }
    .admin-topbar__profile-dropdown a i,
    .admin-topbar__profile-dropdown button i { width: 18px; text-align: center; color: var(--admin-text-muted); }
    .admin-topbar__profile-dropdown .admin-profile-dropdown__logout { color: var(--admin-danger); }
    .admin-topbar__profile-dropdown .admin-profile-dropdown__logout i { color: var(--admin-danger); }
    .admin-topbar__profile-dropdown .admin-profile-dropdown__divider { height: 1px; background: var(--admin-border); margin: 0.5rem 0; padding: 0; }
    .admin-content {
      flex: 1; width: 100%; min-height: calc(100vh - 5rem); box-sizing: border-box;
      max-width: 1360px; margin: 0 auto; padding: 2rem 2rem;
    }
    #view-settings.is-active { width: 100%; min-height: calc(100vh - 8rem); display: flex; flex-direction: column; }
    #view-settings.is-active .admin-page-intro { max-width: none; margin-bottom: 1.75rem; }
    .admin-settings-page {
      width: 100%; flex: 1; display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem;
      align-content: start;
    }
    .admin-settings-page > .admin-settings-section { grid-column: 1 / -1; }
    .admin-settings-page > .admin-settings-block { grid-column: span 1; }
    .admin-settings-page > .admin-settings-block.admin-settings-block--full { grid-column: 1 / -1; }
    .admin-settings-page > .admin-settings-grid { grid-column: 1 / -1; display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem; }
    .admin-settings-page > .admin-settings-actions { grid-column: 1 / -1; }
    .admin-settings-info {
      background: var(--admin-surface); border: 1px solid var(--admin-border); border-radius: var(--admin-radius);
      padding: 1.5rem 1.75rem; box-shadow: var(--admin-shadow); display: flex; flex-direction: column; justify-content: center;
    }
    .admin-settings-info__title { font-size: 0.9375rem; font-weight: 600; color: var(--admin-text); margin: 0 0 0.5rem; }
    .admin-settings-info__text { font-size: 0.8125rem; color: var(--admin-text-muted); margin: 0; line-height: 1.5; }
    .admin-settings-info i { color: var(--admin-accent); margin-bottom: 0.5rem; font-size: 1.25rem; }
    @media (max-width: 900px) {
      .admin-settings-page { grid-template-columns: 1fr; }
      .admin-settings-page > .admin-settings-grid { grid-template-columns: 1fr; }
    }
    .admin-settings-block {
      background: var(--admin-surface); border: 1px solid var(--admin-border); border-radius: var(--admin-radius);
      padding: 1.5rem 1.75rem; box-shadow: var(--admin-shadow); min-height: 0;
      transition: box-shadow var(--admin-transition);
    }
    .admin-settings-block:hover { box-shadow: var(--admin-shadow-hover); }
    .admin-settings-block__head { display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem; }
    .admin-settings-block__icon {
      width: 44px; height: 44px; border-radius: var(--admin-radius-sm); background: rgba(13,148,136,0.12);
      color: var(--admin-accent); display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-size: 1.125rem;
    }
    .admin-settings-block__title { font-size: 1.0625rem; font-weight: 700; color: var(--admin-text); margin: 0 0 0.25rem; }
    .admin-settings-block__desc { font-size: 0.875rem; color: var(--admin-text-muted); margin: 0; line-height: 1.5; }
    .admin-settings-block .form-group { margin-bottom: 1rem; }
    .admin-settings-block .form-group:last-child { margin-bottom: 0; }
    .admin-settings-block .form-input { max-width: 380px; }
    .admin-settings-actions { margin-top: 0.5rem; padding-top: 1.5rem; border-top: 1px solid var(--admin-border); }
    .admin-settings-section {
      font-size: 0.6875rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.08em; color: var(--admin-text-muted);
      margin: 1.25rem 0 0.5rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--admin-border);
    }
    .admin-settings-section:first-child { margin-top: 0; }
    .admin-table--compact.admin-table th,
    .admin-table--compact.admin-table td { padding: 0.5rem 0.75rem; font-size: 0.8125rem; }
    [data-theme="dark"] { --admin-bg: #0f172a; --admin-surface: #1e293b; --admin-text: #f1f5f9; --admin-text-muted: #94a3b8; --admin-border: #334155; --admin-shadow: 0 1px 3px rgba(0,0,0,0.3); --admin-accent-light: rgba(13,148,136,0.2); --admin-sidebar: #020617; --admin-sidebar-border: rgba(255,255,255,0.06); --admin-sidebar-hover: rgba(255,255,255,0.08); --admin-sidebar-active: rgba(13,148,136,0.25); }
    [data-theme="dark"] .admin-card__head,
    [data-theme="dark"] .admin-table th { background: #334155; }
    [data-theme="dark"] .admin-users-toolbar { background: #334155; border-color: var(--admin-border); }
    [data-theme="dark"] .admin-users-toolbar--live { background: linear-gradient(135deg, rgba(59,130,246,0.12) 0%, rgba(13,148,136,0.08) 50%); border-bottom-color: rgba(59,130,246,0.3); }
    [data-theme="dark"] .admin-users-table thead th { background: rgba(59,130,246,0.15); color: #93c5fd; border-bottom-color: rgba(59,130,246,0.3); }
    [data-theme="dark"] .admin-users-table tbody tr:nth-child(even) { background: rgba(30,41,59,0.5); }
    [data-theme="dark"] .admin-users-table tbody tr:hover { background: rgba(59,130,246,0.12); }
    [data-theme="dark"] .admin-users-pagination { background: rgba(30,41,59,0.6); border-top-color: rgba(59,130,246,0.2); }
    [data-theme="dark"] .admin-activity-toolbar { background: #334155; border-color: var(--admin-border); }
    [data-theme="dark"] .admin-activity-toolbar--live { background: linear-gradient(135deg, rgba(13,148,136,0.12) 0%, rgba(59,130,246,0.08) 50%); border-bottom-color: rgba(13,148,136,0.3); }
    [data-theme="dark"] .admin-activity-table thead th { background: rgba(13,148,136,0.15); color: #5eead4; border-bottom-color: rgba(13,148,136,0.3); }
    [data-theme="dark"] .admin-activity-table tbody tr:nth-child(even) { background: rgba(30,41,59,0.5); }
    [data-theme="dark"] .admin-activity-table tbody tr:hover { background: rgba(13,148,136,0.12); }
    [data-theme="dark"] .admin-activity-pagination { background: rgba(30,41,59,0.6); border-top-color: rgba(13,148,136,0.2); }
    [data-theme="dark"] .admin-overview-hero { background: linear-gradient(135deg, rgba(13,148,136,0.2) 0%, rgba(20,184,166,0.15) 50%); border-color: rgba(13,148,136,0.3); }
    [data-theme="dark"] .admin-overview-hero__title { color: #99f6e4; }
    [data-theme="dark"] .admin-overview-hero__sub { color: #5eead4; }
    [data-theme="dark"] .admin-overview-snapshot { background: rgba(59,130,246,0.1); border-color: rgba(59,130,246,0.2); }
    [data-theme="dark"] .admin-overview-chart-card--teal .admin-chart-card__title { color: #5eead4; }
    [data-theme="dark"] .admin-overview-chart-card--blue .admin-chart-card__title { color: #93c5fd; }
    [data-theme="dark"] .admin-overview-chart-card--violet .admin-chart-card__title { color: #a78bfa; }
    [data-theme="dark"] .admin-overview-chart-card--green .admin-chart-card__title { color: #34d399; }
    [data-theme="dark"] .admin-overview-chart-card--amber .admin-chart-card__title { color: #fbbf24; }
    [data-theme="dark"] .admin-profile-intro { background: rgba(13,148,136,0.12); border-color: rgba(13,148,136,0.3); }
    [data-theme="dark"] .admin-profile-header { background: linear-gradient(135deg, #0f766e 0%, #134e4a 100%); }
    [data-theme="dark"] .admin-profile-wrap { border-color: rgba(13,148,136,0.35); }
    [data-theme="dark"] .admin-team-toolbar { background: linear-gradient(135deg, rgba(139,92,246,0.12) 0%, rgba(59,130,246,0.08) 50%); border-bottom-color: rgba(139,92,246,0.3); }
    [data-theme="dark"] .admin-team-table thead th { background: rgba(139,92,246,0.15); color: #a78bfa; border-bottom-color: rgba(139,92,246,0.3); }
    [data-theme="dark"] .admin-team-table tbody tr:nth-child(even) { background: rgba(30,41,59,0.5); }
    [data-theme="dark"] .admin-team-table tbody tr:hover { background: rgba(139,92,246,0.12); }
    [data-theme="dark"] .admin-team-add-card__head { background: linear-gradient(135deg, rgba(13,148,136,0.12) 0%, rgba(139,92,246,0.08) 100%); border-bottom-color: rgba(13,148,136,0.25); }
    [data-theme="dark"] .admin-topbar__profile-dropdown { background: var(--admin-surface); border-color: var(--admin-border); }
    [data-theme="dark"] .admin-settings-block__icon { background: rgba(13,148,136,0.2); }
    .admin-page-intro { font-size: 0.9375rem; color: var(--admin-text-muted); margin: 0 0 1.75rem; line-height: 1.65; max-width: 720px; width: 100%; }
    .admin-kpi-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.25rem; margin-bottom: 1.75rem; width: 100%; }
    .admin-kpi-row.admin-kpi-row--4 { grid-template-columns: repeat(4, 1fr); }
    .admin-kpi-card {
      background: var(--admin-surface); border-radius: var(--admin-radius); padding: 1.5rem 1.6rem;
      box-shadow: var(--admin-shadow); border: 1px solid var(--admin-border);
      transition: box-shadow var(--admin-transition), transform var(--admin-transition), border-color var(--admin-transition);
    }
    .admin-kpi-card:hover { box-shadow: var(--admin-shadow-hover); transform: translateY(-2px); border-color: #cbd5e1; }
    .admin-kpi-card__icon {
      width: 48px; height: 48px; border-radius: var(--admin-radius-sm); display: flex; align-items: center; justify-content: center;
      margin-bottom: 1rem; font-size: 1.2rem; transition: transform var(--admin-transition);
    }
    .admin-kpi-card:hover .admin-kpi-card__icon { transform: scale(1.05); }
    .admin-kpi-card .admin-kpi-card__icon { background: var(--admin-accent-light); color: var(--admin-accent); }
    .admin-kpi-card--pending .admin-kpi-card__icon { background: rgba(100,116,139,0.12); color: #64748b; }
    .admin-kpi-card--validated .admin-kpi-card__icon { background: var(--admin-accent-light); color: var(--admin-accent); }
    .admin-kpi-card__label { font-size: 0.8125rem; color: var(--admin-text-muted); margin-bottom: 0.35rem; font-weight: 600; }
    .admin-kpi-card__value { font-size: 1.85rem; font-weight: 700; color: var(--admin-text); letter-spacing: -0.03em; line-height: 1.2; }
    .admin-card {
      background: var(--admin-surface); border-radius: var(--admin-radius);
      box-shadow: var(--admin-shadow); border: 1px solid var(--admin-border);
      overflow: hidden; transition: box-shadow var(--admin-transition), border-color var(--admin-transition);
    }
    .admin-card:hover { box-shadow: var(--admin-shadow-hover); }
    .admin-card__head { padding: 1.35rem 1.5rem; border-bottom: 1px solid var(--admin-border); background: linear-gradient(180deg, #fafbfc 0%, #f8fafc 100%); }
    .admin-card__title { font-size: 1.0625rem; font-weight: 700; color: var(--admin-text); margin: 0; }
    .admin-card__sub { font-size: 0.8125rem; color: var(--admin-text-muted); margin-top: 0.25rem; }
    .admin-table-wrap { overflow-x: auto; border-radius: 0 0 var(--admin-radius) var(--admin-radius); }
    .admin-table { width: 100%; border-collapse: collapse; font-size: 0.875rem; }
    .admin-table th {
      text-align: left; padding: 1rem 1.25rem; background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
      color: var(--admin-text-muted); font-weight: 700; font-size: 0.7rem;
      text-transform: uppercase; letter-spacing: 0.06em; border-bottom: 2px solid var(--admin-border);
      white-space: nowrap;
    }
    .admin-table td {
      padding: 1rem 1.25rem; border-bottom: 1px solid var(--admin-border);
      color: var(--admin-text); vertical-align: middle;
    }
    .admin-table tbody tr { transition: background var(--admin-transition); }
    .admin-table tbody tr:hover { background: var(--admin-accent-light); }
    .admin-table tbody tr:last-child td { border-bottom: none; }
    .admin-badge {
      display: inline-flex; align-items: center; padding: 0.3rem 0.7rem;
      border-radius: 9999px; font-size: 0.6875rem; font-weight: 700;
      text-transform: uppercase; letter-spacing: 0.04em;
    }
    .admin-badge--validated { background: var(--admin-accent-light); color: #0f766e; border: 1px solid rgba(13,148,136,0.2); }
    .admin-badge--pending { background: rgba(100,116,139,0.1); color: #475569; border: 1px solid rgba(100,116,139,0.15); }
    .admin-activity { font-size: 0.8125rem; color: var(--admin-text-muted); }
    .admin-actions-cell { display: flex; flex-wrap: wrap; gap: 0.375rem; align-items: center; }
    .admin-users-toolbar {
      display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;
      padding: 1.1rem 1.5rem; border-bottom: 1px solid var(--admin-border);
      background: linear-gradient(180deg, #fafbfc 0%, #f8fafc 100%);
    }
    .admin-users-toolbar__left { display: flex; align-items: center; gap: 0.75rem; flex-wrap: wrap; }
    .admin-users-toolbar__right { display: flex; align-items: center; gap: 0.75rem; flex-wrap: wrap; }
    .admin-users-toolbar__title { font-size: 1.05rem; font-weight: 700; color: var(--admin-text); margin: 0; display: flex; align-items: center; gap: 0.5rem; }
    .admin-users-toolbar__title i { color: var(--admin-accent); }
    .admin-users-toolbar__live {
      display: inline-flex; align-items: center; gap: 0.4rem; padding: 0.35rem 0.65rem; border-radius: 9999px;
      font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.06em;
      background: rgba(16,185,129,0.15); color: #059669; border: 1px solid rgba(16,185,129,0.3);
    }
    .admin-users-toolbar__live i { font-size: 0.45rem; color: #10b981; animation: admin-pulse 1.5s ease-in-out infinite; }
    .admin-users-toolbar__count {
      font-size: 0.875rem; font-weight: 600; padding: 0.35rem 0.65rem; border-radius: 6px;
      background: rgba(59,130,246,0.1); color: #2563eb; border: 1px solid rgba(59,130,246,0.2);
    }
    .admin-users-toolbar__label { font-size: 0.8125rem; font-weight: 600; color: var(--admin-text-muted); margin: 0; }
    .admin-users-toolbar__select {
      padding: 0.5rem 2rem 0.5rem 0.75rem; border: 1px solid var(--admin-border); border-radius: var(--admin-radius-sm);
      font-size: 0.875rem; font-family: inherit; background: var(--admin-surface); color: var(--admin-text);
      min-width: 200px;
    }
    .admin-users-toolbar--live {
      background: linear-gradient(135deg, rgba(59,130,246,0.06) 0%, rgba(13,148,136,0.05) 50%, rgba(139,92,246,0.05) 100%);
      border-bottom: 2px solid rgba(59,130,246,0.2); padding: 1.25rem 1.5rem;
    }
    .admin-users-toolbar__select--filter { border-color: rgba(59,130,246,0.35); background: rgba(255,255,255,0.8); }
    .admin-users-strip {
      display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 0;
      width: 100%; padding: 1.25rem 1.5rem; margin-bottom: 1.75rem; border-radius: var(--admin-radius);
      background: linear-gradient(90deg, #f1f5f9 0%, #e2e8f0 50%, #f1f5f9 100%);
      border: 1px solid rgba(148,163,184,0.4); box-shadow: inset 0 1px 0 rgba(255,255,255,0.6);
    }
    .admin-users-strip__item {
      display: flex; align-items: center; gap: 0.5rem; flex: 1; min-width: 0; justify-content: center;
      padding: 0.25rem 0.75rem;
    }
    .admin-users-strip__icon { font-size: 1.1rem; color: var(--admin-accent); width: 20px; text-align: center; }
    .admin-users-strip__value { font-size: 1.35rem; font-weight: 800; color: var(--admin-text); letter-spacing: -0.02em; }
    .admin-users-strip__label { font-size: 0.75rem; font-weight: 600; color: var(--admin-text-muted); text-transform: uppercase; letter-spacing: 0.04em; }
    .admin-users-strip__divider {
      width: 1px; height: 32px; background: rgba(148,163,184,0.5); flex-shrink: 0;
    }
    @media (max-width: 992px) {
      .admin-users-strip { flex-wrap: wrap; gap: 1rem; padding: 1rem; }
      .admin-users-strip__item { flex: 1 1 calc(33.333% - 1rem); min-width: 100px; justify-content: flex-start; }
      .admin-users-strip__divider { display: none; }
    }
    @media (max-width: 576px) {
      .admin-users-strip__item { flex: 1 1 100%; justify-content: flex-start; padding: 0.5rem 0; border-bottom: 1px solid rgba(148,163,184,0.3); }
      .admin-users-strip__item:last-child { border-bottom: none; }
    }
    .admin-users-card { box-shadow: 0 2px 12px rgba(59,130,246,0.08); }
    .admin-users-table thead th {
      background: linear-gradient(180deg, rgba(59,130,246,0.08) 0%, rgba(59,130,246,0.04) 100%);
      color: #1d4ed8; font-weight: 800; font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.08em;
      border-bottom: 2px solid rgba(59,130,246,0.2); padding: 1rem 1.25rem;
    }
    .admin-users-table tbody tr:nth-child(even) { background: rgba(248,250,252,0.8); }
    .admin-users-table tbody tr:hover { background: rgba(59,130,246,0.06); }
    .admin-users-card .admin-badge--validated {
      background: linear-gradient(135deg, rgba(16,185,129,0.2), rgba(5,150,105,0.15));
      color: #047857; border: 1px solid rgba(16,185,129,0.4); font-weight: 700;
    }
    .admin-users-card .admin-badge--pending {
      background: linear-gradient(135deg, rgba(245,158,11,0.2), rgba(217,119,6,0.12));
      color: #b45309; border: 1px solid rgba(245,158,11,0.4); font-weight: 700;
    }
    .admin-users-bulk {
      display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;
      padding: 1rem 1.5rem; background: linear-gradient(135deg, rgba(13,148,136,0.12) 0%, rgba(59,130,246,0.08) 100%);
      border-bottom: 2px solid rgba(13,148,136,0.2);
    }
    .admin-users-bulk__count { font-size: 0.875rem; font-weight: 600; color: var(--admin-text); }
    .admin-users-bulk__actions { display: flex; flex-wrap: wrap; gap: 0.5rem; align-items: center; }
    .admin-users-pagination {
      padding: 1rem 1.5rem; background: linear-gradient(180deg, rgba(248,250,252,0.9) 0%, rgba(241,245,249,0.6) 100%);
      border-top: 1px solid rgba(59,130,246,0.12);
    }
    .admin-users-empty { background: linear-gradient(180deg, rgba(248,250,252,0.5) 0%, rgba(241,245,249,0.3) 100%); border-radius: 0 0 var(--admin-radius) var(--admin-radius); }
    .admin-table__cell-checkbox { width: 44px; text-align: center; vertical-align: middle; }
    .admin-checkbox-label { margin: 0; cursor: pointer; display: inline-flex; align-items: center; justify-content: center; }
    .admin-checkbox { width: 18px; height: 18px; cursor: pointer; accent-color: var(--admin-accent); }
    .admin-btn--secondary { background: var(--admin-surface); color: var(--admin-text-muted); border: 1px solid var(--admin-border); }
    .admin-btn--secondary:hover { background: var(--admin-bg); color: var(--admin-text); }
    .admin-activity-toolbar {
      display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;
      padding: 1.1rem 1.5rem; border-bottom: 1px solid var(--admin-border);
      background: linear-gradient(180deg, #fafbfc 0%, #f8fafc 100%);
    }
    .admin-activity-toolbar__left { display: flex; align-items: center; gap: 0.75rem; flex-wrap: wrap; }
    .admin-activity-toolbar__title { font-size: 1.05rem; font-weight: 700; color: var(--admin-text); margin: 0; display: flex; align-items: center; gap: 0.5rem; }
    .admin-activity-toolbar__title i { color: var(--admin-accent); }
    .admin-activity-toolbar__right { display: flex; align-items: center; gap: 0.75rem; flex-wrap: wrap; }
    .admin-activity-toolbar__label { font-size: 0.8125rem; font-weight: 600; color: var(--admin-text-muted); margin: 0; }
    .admin-activity-toolbar__select {
      padding: 0.5rem 2rem 0.5rem 0.75rem; border: 1px solid var(--admin-border); border-radius: var(--admin-radius-sm);
      font-size: 0.875rem; font-family: inherit; background: var(--admin-surface); color: var(--admin-text);
      min-width: 120px;
    }
    .admin-activity-summary-card { box-shadow: 0 2px 12px rgba(13,148,136,0.08); }
    .admin-activity-toolbar--live {
      background: linear-gradient(135deg, rgba(13,148,136,0.06) 0%, rgba(59,130,246,0.05) 50%, rgba(139,92,246,0.05) 100%);
      border-bottom: 2px solid rgba(13,148,136,0.2);
      padding: 1.25rem 1.5rem;
    }
    .admin-activity-toolbar__live {
      display: inline-flex; align-items: center; gap: 0.4rem; padding: 0.35rem 0.65rem; border-radius: 9999px;
      font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.06em;
      background: rgba(16,185,129,0.15); color: #059669; border: 1px solid rgba(16,185,129,0.3);
    }
    .admin-activity-toolbar__live i { font-size: 0.45rem; color: #10b981; animation: admin-pulse 1.5s ease-in-out infinite; }
    @keyframes admin-pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }
    .admin-activity-toolbar__count {
      font-size: 0.875rem; font-weight: 600; color: var(--admin-text-muted);
      padding: 0.35rem 0.65rem; border-radius: 6px; background: rgba(59,130,246,0.1); color: #2563eb;
      border: 1px solid rgba(59,130,246,0.2);
    }
    .admin-activity-toolbar__select--filter { border-color: rgba(13,148,136,0.35); background: rgba(255,255,255,0.8); }
    .admin-activity-table-wrap { border-radius: 0 0 var(--admin-radius) var(--admin-radius); }
    .admin-activity-table thead th {
      background: linear-gradient(180deg, rgba(13,148,136,0.08) 0%, rgba(13,148,136,0.04) 100%);
      color: #0f766e; font-weight: 800; font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.08em;
      border-bottom: 2px solid rgba(13,148,136,0.2); padding: 1rem 1.25rem;
    }
    .admin-activity-table tbody tr:nth-child(even) { background: rgba(248,250,252,0.8); }
    .admin-activity-table tbody tr:hover { background: rgba(13,148,136,0.06); }
    .admin-activity-table .admin-activity-avatar {
      background: linear-gradient(145deg, #14b8a6, #0d9488); box-shadow: 0 2px 8px rgba(20,184,166,0.35);
    }
    .admin-activity-summary-card .admin-badge--validated {
      background: linear-gradient(135deg, rgba(16,185,129,0.2), rgba(5,150,105,0.15));
      color: #047857; border: 1px solid rgba(16,185,129,0.4); font-weight: 700;
    }
    .admin-activity-summary-card .admin-badge--pending {
      background: linear-gradient(135deg, rgba(245,158,11,0.2), rgba(217,119,6,0.12));
      color: #b45309; border: 1px solid rgba(245,158,11,0.4); font-weight: 700;
    }
    .admin-activity-pagination {
      padding: 1rem 1.5rem; background: linear-gradient(180deg, rgba(248,250,252,0.9) 0%, rgba(241,245,249,0.6) 100%);
      border-top: 1px solid rgba(13,148,136,0.12);
    }
    .admin-activity-empty { background: linear-gradient(180deg, rgba(248,250,252,0.5) 0%, rgba(241,245,249,0.3) 100%); border-radius: 0 0 var(--admin-radius) var(--admin-radius); }
    .admin-activity-kpis { grid-template-columns: repeat(6, 1fr); width: 100%; gap: 1rem; }
    .admin-activity-kpis .admin-analysis-kpi { min-width: 0; width: 100%; box-sizing: border-box; padding: 1.25rem 1rem; }
    .admin-activity-kpis .admin-analysis-kpi__value { font-size: 2rem; }
    .admin-activity-kpis .admin-analysis-kpi__icon { font-size: 1.65rem; }
    @media (max-width: 1200px) { .admin-activity-kpis { grid-template-columns: repeat(3, 1fr); } }
    @media (max-width: 992px) { .admin-activity-kpis { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 576px) { .admin-activity-kpis { grid-template-columns: 1fr; } }
    .admin-table__cell-avatar { width: 48px; text-align: center; vertical-align: middle; }
    .admin-table .admin-activity-avatar {
      width: 38px; height: 38px; border-radius: 50%; background: linear-gradient(145deg, var(--admin-accent), #0f766e);
      color: #fff; font-weight: 700; font-size: 0.9rem; display: inline-flex; align-items: center; justify-content: center;
      box-shadow: 0 2px 8px rgba(13,148,136,0.25);
    }
    .admin-btn {
      padding: 0.45rem 0.9rem; font-size: 0.8125rem; border-radius: var(--admin-radius-sm);
      border: none; cursor: pointer; font-weight: 600; font-family: inherit;
      transition: background var(--admin-transition), transform 0.15s ease, box-shadow 0.2s ease;
      display: inline-flex; align-items: center; gap: 0.4rem;
    }
    .admin-btn:active { transform: scale(0.97); }
    .admin-btn--validate { background: var(--admin-accent); color: #fff; box-shadow: 0 2px 8px rgba(13,148,136,0.25); }
    .admin-btn--validate:hover { background: var(--admin-accent-hover); box-shadow: 0 4px 12px rgba(13,148,136,0.3); }
    .admin-btn--validate:disabled { opacity: 0.6; cursor: not-allowed; transform: none; box-shadow: none; }
    .admin-btn--edit { background: var(--admin-primary); color: #fff; }
    .admin-btn--edit:hover { background: #334155; }
    .admin-btn--delete { background: var(--admin-danger); color: #fff; }
    .admin-btn--delete:hover { background: var(--admin-danger-hover); }
    .admin-empty {
      text-align: center; padding: 3.5rem 1.5rem; color: var(--admin-text-muted);
      font-size: 0.9375rem; line-height: 1.55; background: var(--admin-surface);
    }
    .admin-empty i { font-size: 2.5rem; margin-bottom: 0.75rem; color: var(--admin-text-muted); opacity: 0.7; }
    .admin-modal-overlay {
      position: fixed; inset: 0; background: rgba(15,23,42,0.5); backdrop-filter: blur(4px);
      z-index: 1000; display: none; align-items: center; justify-content: center;
      padding: 1.5rem; opacity: 0; transition: opacity var(--admin-transition);
    }
    .admin-modal-overlay.is-open { display: flex; opacity: 1; }
    .admin-modal {
      background: var(--admin-surface); border-radius: var(--admin-radius);
      max-width: 440px; width: 100%; max-height: 90vh; overflow-y: auto;
      box-shadow: var(--admin-shadow-lg); border: 1px solid var(--admin-border);
      transform: scale(0.98); transition: transform var(--admin-transition);
    }
    .admin-modal-overlay.is-open .admin-modal { transform: scale(1); }
    .admin-modal__header {
      padding: 1.25rem 1.5rem; border-bottom: 1px solid var(--admin-border);
      display: flex; align-items: center; justify-content: space-between;
    }
    .admin-modal__title { margin: 0; font-size: 1.125rem; font-weight: 700; color: var(--admin-text); }
    .admin-modal__close {
      background: none; border: none; font-size: 1.5rem; color: var(--admin-text-muted);
      cursor: pointer; padding: 0.25rem; line-height: 1; border-radius: var(--admin-radius-sm);
      transition: background var(--admin-transition), color var(--admin-transition);
    }
    .admin-modal__close:hover { background: var(--admin-bg); color: var(--admin-text); }
    .admin-modal__body { padding: 1.5rem; }
    .form-group { margin-bottom: 1.25rem; }
    .form-group:last-child { margin-bottom: 0; }
    .form-group label { display: block; font-weight: 600; margin-bottom: 0.5rem; font-size: 0.8125rem; color: var(--admin-text); line-height: 1.3; }
    .form-input,
    input.form-input,
    select.form-input,
    .admin-profile-input {
      display: block; width: 100%; max-width: 100%; box-sizing: border-box;
      min-height: 44px; padding: 0.625rem 1rem;
      border: 1px solid var(--admin-border); border-radius: 8px;
      font-size: 0.9375rem; font-family: inherit; color: var(--admin-text);
      background: var(--admin-surface); line-height: 1.4;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    .form-input:focus,
    .admin-profile-input:focus {
      outline: none; border-color: var(--admin-accent); box-shadow: 0 0 0 3px rgba(13,148,136,0.18);
    }
    .form-input::placeholder { color: var(--admin-text-muted); opacity: 0.9; }
    select.form-input { cursor: pointer; appearance: auto; }
    .admin-form .form-group { margin-bottom: 1.25rem; }
    .admin-form .form-group:last-child { margin-bottom: 0; }
    .admin-modal__footer {
      padding: 1rem 1.5rem; border-top: 1px solid var(--admin-border);
      display: flex; justify-content: flex-end; gap: 0.5rem;
    }
    .admin-modal__footer .admin-topbar__btn { border: 1px solid var(--admin-border); }
    .admin-view { display: none; width: 100%; min-width: 0; }
    .admin-view.is-active { display: block; width: 100%; min-height: 0; }
    .admin-content { width: 100%; box-sizing: border-box; }
    .admin-charts-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1.25rem; margin-bottom: 1.75rem; width: 100%; }
    .admin-charts-row--full { grid-template-columns: 1fr; max-width: none; }
    .admin-chart-card, .admin-card { min-width: 0; width: 100%; box-sizing: border-box; }
    .admin-chart-card {
      padding: 1.5rem 1.6rem; border-radius: var(--admin-radius); border: 1px solid var(--admin-border);
      background: var(--admin-surface); box-shadow: var(--admin-shadow);
      transition: box-shadow var(--admin-transition);
    }
    .admin-chart-card:hover { box-shadow: var(--admin-shadow-hover); }
    .admin-chart-card__title { font-size: 1.05rem; font-weight: 700; color: var(--admin-text); margin: 0 0 0.4rem; }
    .admin-chart-card__hint { font-size: 0.8125rem; color: var(--admin-text-muted); margin-bottom: 1rem; line-height: 1.5; }
    .admin-chart-wrap { position: relative; height: 260px; display: flex; align-items: center; justify-content: center; }
    .admin-overview-hero {
      background: linear-gradient(135deg, #f0fdfa 0%, #ccfbf1 30%, #99f6e4 60%, #5eead4 100%);
      color: var(--admin-text);
      padding: 1.75rem 2rem;
      border-radius: var(--admin-radius);
      margin-bottom: 1.25rem;
      border: 1px solid rgba(13,148,136,0.25);
      box-shadow: 0 4px 20px rgba(13,148,136,0.15);
      width: 100%; box-sizing: border-box;
    }
    .admin-overview-hero__live {
      display: inline-flex; align-items: center; gap: 0.4rem; padding: 0.3rem 0.6rem; border-radius: 9999px;
      font-size: 0.68rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.06em;
      background: rgba(13,148,136,0.25); color: #0f766e; border: 1px solid rgba(13,148,136,0.4);
      margin-bottom: 0.75rem;
    }
    .admin-overview-hero__live i { font-size: 0.4rem; color: #0d9488; animation: admin-pulse 1.5s ease-in-out infinite; }
    .admin-overview-hero__title { font-size: 1.6rem; font-weight: 800; margin: 0 0 0.35rem; color: #134e4a; letter-spacing: -0.02em; }
    .admin-overview-hero__sub { margin: 0; font-size: 0.9375rem; color: #0f766e; line-height: 1.5; opacity: 0.95; }
    .admin-overview-highlight {
      background: linear-gradient(135deg, #0d9488 0%, #0f766e 50%, #115e59 100%);
      color: #fff;
      padding: 1.75rem 2rem;
      width: 100%; box-sizing: border-box;
      border-radius: var(--admin-radius);
      margin-bottom: 1rem;
      box-shadow: 0 8px 24px rgba(13,148,136,0.35);
      display: flex; align-items: center; justify-content: space-between; gap: 1.5rem; flex-wrap: wrap;
    }
    .admin-overview-highlight__text h3 { font-size: 1.0625rem; font-weight: 700; margin: 0 0 0.35rem; color: #fff; }
    .admin-overview-highlight__text p { margin: 0; font-size: 0.875rem; opacity: 0.95; }
    .admin-overview-highlight__progress { width: 84px; height: 84px; border-radius: 50%; background: rgba(255,255,255,0.22); display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 1.35rem; flex-shrink: 0; border: 3px solid rgba(255,255,255,0.45); box-shadow: inset 0 0 0 2px rgba(255,255,255,0.15); }
    .admin-overview-highlight__link { color: #fff; font-size: 0.875rem; font-weight: 600; text-decoration: none; display: inline-flex; align-items: center; gap: 0.35rem; margin-top: 0.5rem; opacity: 0.95; }
    .admin-overview-highlight__link:hover { color: #fff; text-decoration: underline; }
    .admin-overview-snapshot {
      display: flex; align-items: center; flex-wrap: wrap; gap: 1.25rem; padding: 1rem 1.25rem; margin-bottom: 1.5rem;
      background: linear-gradient(90deg, rgba(59,130,246,0.08) 0%, rgba(139,92,246,0.06) 50%, rgba(13,148,136,0.08) 100%);
      border-radius: var(--admin-radius); border: 1px solid rgba(59,130,246,0.15);
      width: 100%; box-sizing: border-box;
    }
    .admin-overview-snapshot__item { font-size: 0.9rem; color: var(--admin-text-muted); }
    .admin-overview-snapshot__item i { color: var(--admin-accent); margin-right: 0.35rem; width: 18px; text-align: center; }
    .admin-overview-snapshot__item strong { color: var(--admin-text); font-weight: 700; }
    .admin-overview-kpi .admin-kpi-card { position: relative; }
    .admin-overview-kpi-card { border-left: 4px solid; box-shadow: var(--admin-shadow); transition: transform 0.2s, box-shadow 0.2s; }
    .admin-overview-kpi-card:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0,0,0,0.1); }
    .admin-overview-kpi-card--blue { background: linear-gradient(180deg, #fff 0%, rgba(59,130,246,0.04) 100%); border-left-color: #3b82f6; }
    .admin-overview-kpi-card--blue .admin-kpi-card__icon { background: rgba(59,130,246,0.15); color: #2563eb; }
    .admin-overview-kpi-card--amber { background: linear-gradient(180deg, #fff 0%, rgba(245,158,11,0.05) 100%); border-left-color: #f59e0b; }
    .admin-overview-kpi-card--amber .admin-kpi-card__icon { background: rgba(245,158,11,0.15); color: #d97706; }
    .admin-overview-kpi-card--green { background: linear-gradient(180deg, #fff 0%, rgba(16,185,129,0.05) 100%); border-left-color: #10b981; }
    .admin-overview-kpi-card--green .admin-kpi-card__icon { background: rgba(16,185,129,0.15); color: #059669; }
    .admin-overview-kpi-card--cyan { background: linear-gradient(180deg, #fff 0%, rgba(6,182,212,0.05) 100%); border-left-color: #06b6d4; }
    .admin-overview-kpi-card--cyan .admin-kpi-card__icon { background: rgba(6,182,212,0.15); color: #0891b2; }
    .admin-overview-kpi .admin-kpi-card .admin-kpi-card__label { color: var(--admin-text-muted); }
    .admin-overview-kpi .admin-kpi-card .admin-kpi-card__value { color: var(--admin-text); }
    .admin-overview-charts { width: 100%; }
    .admin-overview-chart-card { border-top: 4px solid var(--admin-border); overflow: hidden; }
    .admin-overview-chart-card--teal { border-top-color: #14b8a6; }
    .admin-overview-chart-card--teal .admin-chart-card__title { color: #0d9488; }
    .admin-overview-chart-card--blue { border-top-color: #3b82f6; }
    .admin-overview-chart-card--blue .admin-chart-card__title { color: #2563eb; }
    .admin-overview-chart-card--violet { border-top-color: #8b5cf6; }
    .admin-overview-chart-card--violet .admin-chart-card__title { color: #7c3aed; }
    .admin-overview-chart-card--green { border-top-color: #10b981; }
    .admin-overview-chart-card--green .admin-chart-card__title { color: #059669; }
    .admin-overview-chart-card--amber { border-top-color: #f59e0b; }
    .admin-overview-chart-card--amber .admin-chart-card__title { color: #d97706; }
    .admin-kpi-card__viewall { font-size: 0.8125rem; font-weight: 600; color: var(--admin-accent); text-decoration: none; margin-top: 0.5rem; display: inline-flex; align-items: center; gap: 0.25rem; }
    .admin-kpi-card__viewall:hover { color: var(--admin-accent-hover); text-decoration: underline; }
    .admin-recent-list__avatar {
      width: 42px; height: 42px; border-radius: 50%; background: linear-gradient(145deg, var(--admin-accent), #0f766e); color: #fff;
      display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.9rem; flex-shrink: 0;
      box-shadow: 0 2px 8px rgba(13,148,136,0.3);
    }
    .admin-status-bars { padding: 0.5rem 0; }
    .admin-status-bar { margin-bottom: 1rem; }
    .admin-status-bar:last-child { margin-bottom: 0; }
    .admin-status-bar__head { display: flex; justify-content: space-between; margin-bottom: 0.35rem; font-size: 0.8125rem; color: var(--admin-text); font-weight: 500; }
    .admin-status-bar__track { height: 10px; background: #e2e8f0; border-radius: 999px; overflow: hidden; }
    .admin-status-bar__fill { height: 100%; border-radius: 999px; background: linear-gradient(90deg, var(--admin-accent), var(--admin-accent-hover)); transition: width 0.35s ease; }
    .admin-status-bar__fill--pending { background: linear-gradient(90deg, #94a3b8, #64748b); }
    .admin-recent-card { display: flex; flex-direction: column; min-height: 320px; }
    .admin-recent-card .admin-chart-card__hint { margin-bottom: 0.75rem; }
    .admin-recent-list { list-style: none; margin: 0; padding: 0; flex: 1; }
    .admin-recent-list li {
      display: flex; align-items: center; justify-content: space-between; gap: 0.75rem;
      padding: 0.75rem 0; border-bottom: 1px solid var(--admin-border); font-size: 0.875rem;
      transition: background var(--admin-transition);
    }
    .admin-recent-list li:hover { background: #f8fafc; }
    .admin-recent-list li:last-child { border-bottom: none; }
    .admin-recent-list__name { font-weight: 600; color: var(--admin-text); }
    .admin-recent-list__email { font-size: 0.8125rem; color: var(--admin-text-muted); }
    .admin-recent-list__date { font-size: 0.75rem; color: var(--admin-text-muted); white-space: nowrap; }
    .admin-recent-pagination {
      display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 0.5rem;
      padding: 0.65rem 0; margin-top: 0.5rem; border-top: 1px solid var(--admin-border);
      font-size: 0.8125rem; color: var(--admin-text-muted);
    }
    .admin-recent-pagination__info { font-weight: 500; color: var(--admin-text); }
    .admin-recent-pagination__nav { display: flex; align-items: center; gap: 0.2rem; }
    .admin-recent-pagination__btn {
      min-width: 28px; height: 28px; padding: 0 0.4rem; border: 1px solid var(--admin-border);
      border-radius: 6px; background: var(--admin-surface); color: var(--admin-text);
      cursor: pointer; font-size: 0.8125rem; font-weight: 500; font-family: inherit;
      transition: background var(--admin-transition), border-color var(--admin-transition);
    }
    .admin-recent-pagination__btn:hover:not(:disabled) { background: var(--admin-bg); border-color: #cbd5e1; }
    .admin-recent-pagination__btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .admin-recent-pagination__btn.active { background: var(--admin-accent); border-color: var(--admin-accent); color: #fff; }
    .admin-activity-legend { display: flex; flex-wrap: wrap; gap: 1rem; margin-top: 1rem; font-size: 0.8125rem; color: var(--admin-text-muted); }
    .admin-activity-legend span { display: inline-flex; align-items: center; gap: 0.375rem; }
    .admin-activity-legend i { width: 10px; height: 10px; border-radius: 50%; }
    .admin-pagination {
      display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 0.75rem;
      padding: 0.75rem 1.25rem; border-top: 1px solid var(--admin-border); background: #f8fafc;
      font-size: 0.875rem; color: var(--admin-text-muted);
    }
    .admin-pagination__info { font-weight: 500; color: var(--admin-text); }
    .admin-pagination__nav { display: flex; align-items: center; gap: 0.35rem; }
    .admin-pagination__btn {
      min-width: 36px; height: 36px; padding: 0 0.6rem; border: 1px solid var(--admin-border);
      border-radius: var(--admin-radius-sm); background: var(--admin-surface); color: var(--admin-text);
      cursor: pointer; font-size: 0.875rem; font-weight: 600; font-family: inherit;
      transition: background var(--admin-transition), border-color var(--admin-transition), color var(--admin-transition);
    }
    .admin-pagination__btn:hover:not(:disabled) { background: var(--admin-accent-light); border-color: var(--admin-accent); color: var(--admin-accent-hover); }
    .admin-pagination__btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .admin-pagination__btn.active { background: var(--admin-accent); border-color: var(--admin-accent); color: #fff; }
    .admin-profile-intro {
      margin-bottom: 1.5rem; padding: 1.25rem 1.5rem;
      background: linear-gradient(135deg, rgba(13,148,136,0.08) 0%, rgba(59,130,246,0.06) 100%);
      border-radius: var(--admin-radius); border: 1px solid rgba(13,148,136,0.2);
      width: 100%; max-width: 720px; margin: 0 auto 1.5rem; box-sizing: border-box;
    }
    .admin-profile-intro__title {
      font-size: 1.35rem; font-weight: 800; color: var(--admin-text); margin: 0 0 0.35rem;
      display: flex; align-items: center; gap: 0.5rem;
    }
    .admin-profile-intro__title i { color: var(--admin-accent); font-size: 1.5rem; }
    .admin-profile-intro__text { font-size: 0.9rem; color: var(--admin-text-muted); margin: 0; line-height: 1.5; }
    .admin-profile-wrap {
      width: 100%; max-width: 720px; margin: 0 auto;
      background: var(--admin-surface); border-radius: var(--admin-radius);
      box-shadow: 0 8px 32px rgba(13,148,136,0.12), 0 2px 8px rgba(0,0,0,0.06);
      border: 1px solid rgba(13,148,136,0.25);
      overflow: hidden;
    }
    .admin-profile-header {
      display: flex; align-items: center; gap: 1.75rem; padding: 1.75rem 2rem;
      background: linear-gradient(135deg, #0d9488 0%, #0f766e 40%, #115e59 100%);
      border-bottom: 4px solid rgba(255,255,255,0.25);
    }
    .admin-profile-header__avatar {
      width: 72px; height: 72px; border-radius: 50%;
      background: rgba(255,255,255,0.28); color: #fff;
      display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 2rem; flex-shrink: 0;
      border: 4px solid rgba(255,255,255,0.55); box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    }
    .admin-profile-header__main { flex: 1; min-width: 0; }
    .admin-profile-header__live {
      display: inline-flex; align-items: center; gap: 0.4rem; padding: 0.3rem 0.6rem; margin-bottom: 0.5rem;
      font-size: 0.68rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.08em;
      background: rgba(255,255,255,0.28); color: #fff; border-radius: 9999px; border: 1px solid rgba(255,255,255,0.4);
    }
    .admin-profile-header__live i { font-size: 0.4rem; animation: admin-pulse 1.5s ease-in-out infinite; }
    .admin-profile-header__name { font-size: 1.5rem; font-weight: 800; color: #fff; margin: 0 0 0.25rem; letter-spacing: -0.02em; }
    .admin-profile-header__meta { font-size: 0.875rem; color: rgba(255,255,255,0.92); }
    .admin-profile-header__role { font-weight: 600; text-transform: uppercase; letter-spacing: 0.04em; }
    .admin-profile-header__sep { margin: 0 0.45rem; opacity: 0.75; }
    .admin-profile-header__username { font-weight: 600; }
    .admin-profile-form-wrap { padding: 2rem 2rem; background: var(--admin-surface); }
    .admin-profile-form__block { margin-bottom: 1.5rem; }
    .admin-profile-form__block:last-of-type { margin-bottom: 0; }
    .admin-profile-form__block-title {
      font-size: 0.82rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.06em; color: var(--admin-accent);
      margin: 0 0 0.85rem; display: flex; align-items: center; gap: 0.5rem;
    }
    .admin-profile-form__block-title i { font-size: 1rem; }
    .admin-profile-form__row { display: grid; grid-template-columns: 1fr 1fr; gap: 1.25rem; }
    @media (max-width: 600px) { .admin-profile-form__row { grid-template-columns: 1fr; } }
    .admin-profile-form__field { margin-bottom: 0; }
    .admin-profile-form .form-group { margin-bottom: 1.25rem; }
    .admin-profile-form .form-group:last-child { margin-bottom: 0; }
    .admin-profile-form label { display: block; font-weight: 600; margin-bottom: 0.5rem; font-size: 0.8125rem; color: var(--admin-text); }
    .admin-profile-form__block + .admin-profile-form__block { margin-top: 1.75rem; padding-top: 1.75rem; border-top: 1px solid var(--admin-border); }
    .admin-profile-form__footer { margin-top: 1.75rem; padding-top: 1.5rem; border-top: 2px solid var(--admin-border); }
    .admin-profile-save-btn {
      padding: 0.7rem 1.5rem; font-size: 0.95rem; font-weight: 700;
      background: linear-gradient(135deg, #0d9488, #0f766e); color: #fff; border: none; border-radius: 8px;
      box-shadow: 0 4px 14px rgba(13,148,136,0.4); cursor: pointer;
      display: inline-flex; align-items: center; gap: 0.5rem; transition: transform 0.15s, box-shadow 0.15s;
    }
    .admin-profile-save-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(13,148,136,0.45); }
    .admin-team-card { overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.08); border: 1px solid var(--admin-border); }
    .admin-team-toolbar {
      display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;
      padding: 1.25rem 1.5rem;
      background: linear-gradient(135deg, rgba(139,92,246,0.08) 0%, rgba(59,130,246,0.06) 50%, rgba(13,148,136,0.06) 100%);
      border-bottom: 2px solid rgba(139,92,246,0.2);
    }
    .admin-team-toolbar__left { display: flex; align-items: center; gap: 0.75rem; flex-wrap: wrap; }
    .admin-team-toolbar__title { font-size: 1.1rem; font-weight: 700; color: var(--admin-text); margin: 0; display: flex; align-items: center; gap: 0.5rem; }
    .admin-team-toolbar__title i { color: #8b5cf6; }
    .admin-team-toolbar__live {
      display: inline-flex; align-items: center; gap: 0.4rem; padding: 0.3rem 0.6rem; border-radius: 9999px;
      font-size: 0.68rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.06em;
      background: rgba(16,185,129,0.15); color: #059669; border: 1px solid rgba(16,185,129,0.3);
    }
    .admin-team-toolbar__live i { font-size: 0.4rem; color: #10b981; animation: admin-pulse 1.5s ease-in-out infinite; }
    .admin-team-toolbar__count {
      font-size: 0.875rem; font-weight: 700; padding: 0.35rem 0.65rem; border-radius: 6px;
      background: rgba(139,92,246,0.12); color: #7c3aed; border: 1px solid rgba(139,92,246,0.25);
    }
    .admin-team-table thead th {
      background: linear-gradient(180deg, rgba(139,92,246,0.08) 0%, rgba(139,92,246,0.04) 100%);
      color: #6d28d9; font-weight: 800; font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.08em;
      border-bottom: 2px solid rgba(139,92,246,0.2); padding: 1rem 1.25rem;
    }
    .admin-team-table tbody tr:nth-child(even) { background: rgba(248,250,252,0.8); }
    .admin-team-table tbody tr:hover { background: rgba(139,92,246,0.06); }
    .admin-team-empty { padding: 2rem 1.5rem !important; text-align: center; background: linear-gradient(180deg, rgba(248,250,252,0.6) 0%, rgba(241,245,249,0.4) 100%); border-radius: 0 0 var(--admin-radius) var(--admin-radius); }
    .admin-team-add-card { margin-top: 1.5rem; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.08); border: 1px solid var(--admin-border); }
    .admin-team-add-card__head {
      padding: 1.25rem 1.5rem; background: linear-gradient(135deg, rgba(13,148,136,0.08) 0%, rgba(139,92,246,0.06) 100%);
      border-bottom: 2px solid rgba(13,148,136,0.2);
    }
    .admin-team-add-card__title { font-size: 1.1rem; font-weight: 700; color: var(--admin-text); margin: 0 0 0.25rem; display: flex; align-items: center; gap: 0.5rem; }
    .admin-team-add-card__title i { color: var(--admin-accent); }
    .admin-team-add-card__sub { font-size: 0.8125rem; color: var(--admin-text-muted); margin: 0; }
    .admin-team-add-form { padding: 1.5rem 1.5rem; }
    .admin-team-add-form__row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem; }
    .admin-team-add-form__row:last-of-type { margin-bottom: 0; }
    @media (max-width: 600px) { .admin-team-add-form__row { grid-template-columns: 1fr; } }
    .admin-team-add-form__footer { margin-top: 1.25rem; padding-top: 1.25rem; border-top: 1px solid var(--admin-border); }
    .admin-team-add-btn {
      padding: 0.6rem 1.25rem; font-size: 0.9rem; font-weight: 700;
      background: linear-gradient(135deg, #0d9488, #0f766e); color: #fff; border: none; border-radius: 8px;
      box-shadow: 0 3px 12px rgba(13,148,136,0.35); cursor: pointer;
      display: inline-flex; align-items: center; gap: 0.5rem; transition: transform 0.15s, box-shadow 0.15s;
    }
    .admin-team-add-btn:hover { transform: translateY(-1px); box-shadow: 0 5px 16px rgba(13,148,136,0.4); }
    .admin-insight-list { list-style: none; margin: 0; padding: 0; }
    .admin-insight-list li { padding: 0.5rem 0; border-bottom: 1px solid var(--admin-border); display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem; }
    .admin-insight-list li:last-child { border-bottom: none; }
    .admin-insight-list li i { color: var(--admin-accent); width: 18px; text-align: center; }
    .admin-insight-list--analysis li { padding: 0.65rem 0; font-size: 0.9rem; }
    .admin-insight-list--analysis li i { width: 22px; font-size: 1rem; }
    .admin-insight-list--analysis .admin-insight-note { margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px dashed var(--admin-border); font-size: 0.8125rem; color: var(--admin-text-muted); font-style: italic; }
    .admin-analysis-kpis { display: grid; grid-template-columns: repeat(6, 1fr); gap: 1rem; margin-bottom: 1.75rem; width: 100%; }
    .admin-analysis-kpi { padding: 1rem 1.25rem; border-radius: var(--admin-radius); border: 1px solid transparent; text-align: center; transition: transform 0.2s, box-shadow 0.2s; min-width: 0; box-sizing: border-box; }
    .admin-analysis-kpi:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(0,0,0,0.12); }
    .admin-analysis-kpi__icon { font-size: 1.5rem; margin-bottom: 0.5rem; opacity: 0.95; }
    .admin-analysis-kpi__value { font-size: 1.75rem; font-weight: 800; line-height: 1.2; letter-spacing: -0.02em; display: block; width: 100%; }
    .admin-analysis-kpi__label { font-size: 0.8rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.04em; margin-top: 0.35rem; opacity: 0.9; display: block; width: 100%; }
    .admin-analysis-kpi--blue { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: #fff; }
    .admin-analysis-kpi--green { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: #fff; }
    .admin-analysis-kpi--amber { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: #fff; }
    .admin-analysis-kpi--teal { background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%); color: #fff; }
    .admin-analysis-kpi--violet { background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); color: #fff; }
    .admin-analysis-kpi--cyan { background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%); color: #fff; }
    .admin-analysis-row { display: grid; gap: 1.25rem; margin-bottom: 1.75rem; width: 100%; }
    .admin-analysis-row--3 { grid-template-columns: repeat(3, 1fr); }
    .admin-analysis-row--2 { grid-template-columns: 1fr 1fr; }
    .admin-analysis-chart .admin-chart-wrap { min-height: 200px; }
    .admin-analysis-stats { padding: 1.5rem 1.6rem; border-radius: var(--admin-radius); border: 1px solid var(--admin-border); background: var(--admin-surface); box-shadow: var(--admin-shadow); transition: box-shadow var(--admin-transition); }
    .admin-analysis-stats:hover { box-shadow: var(--admin-shadow-hover); }
    .admin-analysis-stats .admin-chart-card__title { font-size: 1.05rem; font-weight: 700; color: var(--admin-text); margin: 0 0 0.4rem; }
    .admin-analysis-stats .admin-chart-card__hint { font-size: 0.8125rem; color: var(--admin-text-muted); margin-bottom: 1rem; line-height: 1.5; }
    .admin-analysis-stat-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; }
    .admin-analysis-stat-item { display: flex; align-items: flex-start; gap: 0.75rem; padding: 1rem 1.1rem; border-radius: 10px; background: var(--admin-bg); border-left: 4px solid var(--admin-primary); font-size: 0.9rem; transition: transform 0.15s, box-shadow 0.15s; }
    .admin-analysis-stat-item:hover { transform: translateX(2px); box-shadow: 0 2px 8px rgba(0,0,0,0.06); }
    .admin-analysis-stat-item__icon { width: 36px; height: 36px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1rem; flex-shrink: 0; color: #fff; }
    .admin-analysis-stat-item__body strong { display: block; font-size: 1.25rem; font-weight: 700; color: var(--admin-text); margin-bottom: 0.2rem; }
    .admin-analysis-stat-item__body span { color: var(--admin-text-muted); font-size: 0.8rem; font-weight: 500; }
    .admin-analysis-stat-item--blue { border-left-color: #3b82f6; }
    .admin-analysis-stat-item--blue .admin-analysis-stat-item__icon { background: linear-gradient(135deg, #3b82f6, #2563eb); }
    .admin-analysis-stat-item--green { border-left-color: #10b981; }
    .admin-analysis-stat-item--green .admin-analysis-stat-item__icon { background: linear-gradient(135deg, #10b981, #059669); }
    .admin-analysis-stat-item--violet { border-left-color: #8b5cf6; }
    .admin-analysis-stat-item--violet .admin-analysis-stat-item__icon { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
    .admin-analysis-stat-item--amber { border-left-color: #f59e0b; }
    .admin-analysis-stat-item--amber .admin-analysis-stat-item__icon { background: linear-gradient(135deg, #f59e0b, #d97706); }
    .admin-analysis-stat-item--teal { border-left-color: #14b8a6; }
    .admin-analysis-stat-item--teal .admin-analysis-stat-item__icon { background: linear-gradient(135deg, #14b8a6, #0d9488); }
    body.admin-role-viewonly #admin-users-bulk { display: none !important; }
    body.admin-role-viewonly #admin-users-table .admin-table__cell-checkbox { display: none !important; }
    body.admin-role-viewonly .admin-team-add-card { display: none !important; }
    body.admin-role-viewonly .admin-team-table th:nth-child(4),
    body.admin-role-viewonly .admin-team-table td:nth-child(4) { display: none !important; }
    @media (max-width: 1200px) { .admin-analysis-kpis { grid-template-columns: repeat(3, 1fr); } .admin-analysis-row--3 { grid-template-columns: 1fr; } }
    @media (max-width: 992px) { .admin-charts-row { grid-template-columns: 1fr; } .admin-kpi-row.admin-kpi-row--4 { grid-template-columns: repeat(2, 1fr); } .admin-analysis-row--2 { grid-template-columns: 1fr; } .admin-analysis-kpis { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 768px) {
      .admin-wrap { flex-direction: row; }
      .admin-sidebar {
        position: fixed; left: 0; top: 0; height: 100vh; width: 280px; z-index: 1001;
        transform: translateX(-100%); transition: transform 0.25s ease, box-shadow 0.25s ease;
        padding: 3.5rem 0 1rem; border-right: 1px solid var(--admin-sidebar-border);
        overflow-y: auto;
      }
      body.admin-menu-open .admin-sidebar { transform: translateX(0); box-shadow: 8px 0 32px rgba(0,0,0,0.2); }
      body.admin-menu-open .admin-sidebar-backdrop {
        opacity: 1; visibility: visible; pointer-events: auto;
      }
      .admin-sidebar-backdrop {
        position: fixed; inset: 0; background: rgba(0,0,0,0.4); z-index: 1000;
        opacity: 0; visibility: hidden; pointer-events: none;
        transition: opacity 0.25s ease, visibility 0.25s ease;
      }
      .admin-burger { display: flex !important; }
      .admin-sidebar__close { display: flex !important; }
      .admin-main { margin-left: 0; }
      .admin-analysis-kpis { grid-template-columns: 1fr; }
      .admin-sidebar__nav { display: block; flex-wrap: nowrap; }
      .admin-sidebar__nav .admin-sidebar__link { margin: 0 0.75rem 0.2rem; }
      .admin-kpi-row { grid-template-columns: 1fr 1fr; }
      .admin-kpi-row .admin-kpi-card:last-child { grid-column: 1 / -1; }
      .admin-table th, .admin-table td { padding: 0.625rem 0.75rem; font-size: 0.8125rem; }
      .admin-content { padding: 1rem; }
      .admin-profile-header { flex-wrap: wrap; padding: 1.25rem; }
    }
  </style>
</head>
<body>
  <div class="admin-wrap">
    <div class="admin-sidebar-backdrop" id="admin-sidebar-backdrop" aria-hidden="true"></div>
    <aside class="admin-sidebar" id="admin-sidebar">
      <button type="button" class="admin-sidebar__close" id="admin-sidebar-close" aria-label="Close menu"><i class="fas fa-times"></i></button>
      <div class="admin-sidebar__logo"><i class="fas fa-shield-alt"></i> Silent Lease</div>
      <div class="admin-sidebar__section">Main</div>
      <nav class="admin-sidebar__nav">
        <a href="#" class="admin-sidebar__link active" data-view="overview"><i class="fas fa-chart-line"></i> Overview</a>
        <a href="#" class="admin-sidebar__link" data-view="users"><i class="fas fa-users"></i> Users</a>
        <a href="#" class="admin-sidebar__link" data-view="activity"><i class="fas fa-tasks"></i> Activity</a>
        <a href="#" class="admin-sidebar__link" data-view="analysis"><i class="fas fa-chart-bar"></i> Analysis</a>
        <a href="#" class="admin-sidebar__link" data-view="profile"><i class="fas fa-user"></i> My profile</a>
        <a href="#" class="admin-sidebar__link" data-view="team"><i class="fas fa-user-shield"></i> Team</a>
        <a href="#" class="admin-sidebar__link" data-view="settings"><i class="fas fa-cog"></i> Settings</a>
      </nav>
    </aside>

    <main class="admin-main">
      <header class="admin-topbar">
        <div style="display: flex; align-items: center;">
          <button type="button" class="admin-burger" id="admin-burger" aria-label="Open menu"><i class="fas fa-bars"></i></button>
          <div>
          <h1 class="admin-topbar__title" id="admin-page-title">Overview</h1>
          <p class="admin-topbar__breadcrumb" id="admin-breadcrumb">Admin &nbsp;&rsaquo;&rsaquo; Dashboard</p>
          </div>
        </div>
        <div class="admin-topbar__actions">
          <div class="admin-topbar__profile" id="admin-topbar-profile" aria-haspopup="true" aria-expanded="false">
            <div class="admin-topbar__profile-avatar" id="admin-topbar-avatar">A</div>
            <div class="admin-topbar__profile-info">
              <p class="admin-topbar__profile-name" id="admin-topbar-name">Administrator</p>
              <p class="admin-topbar__profile-role" id="admin-topbar-role">Full access</p>
            </div>
            <span class="admin-topbar__profile-chevron"><i class="fas fa-chevron-down"></i></span>
            <ul class="admin-topbar__profile-dropdown" id="admin-profile-dropdown">
              <li><a href="index.html"><i class="fas fa-home"></i> Home</a></li>
              <li><a href="#" data-view="profile"><i class="fas fa-user"></i> My profile</a></li>
              <li><a href="#" data-view="settings"><i class="fas fa-cog"></i> Settings</a></li>
              <li class="admin-profile-dropdown__divider"></li>
              <li><button type="button" class="admin-profile-dropdown__logout" id="admin-logout"><i class="fas fa-sign-out-alt"></i> Logout</button></li>
            </ul>
          </div>
        </div>
      </header>

      <div class="admin-content">
        <!-- Overview -->
        <div class="admin-view is-active" id="view-overview">
          <div class="admin-overview-hero">
            <div class="admin-overview-hero__content">
              <span class="admin-overview-hero__live"><i class="fas fa-circle"></i> Live</span>
              <h2 id="overview-welcome-title" class="admin-overview-hero__title">Welcome back!</h2>
              <p class="admin-overview-hero__sub">Track users, validation, and recent sign-ups. Data updates as you go.</p>
            </div>
          </div>
          <div class="admin-overview-highlight">
            <div class="admin-overview-highlight__text">
              <h3>Validation progress</h3>
              <p id="overview-highlight-copy">You have validated <strong id="overview-highlight-pct">0%</strong> of users. View all users to validate pending registrations.</p>
              <a href="#" class="admin-overview-highlight__link" id="overview-view-users">View all users â†’</a>
            </div>
            <div class="admin-overview-highlight__progress" id="overview-highlight-circle">0%</div>
          </div>
          <div class="admin-overview-snapshot">
            <span class="admin-overview-snapshot__item"><i class="fas fa-chart-pie"></i> Validation rate: <strong id="overview-snapshot-rate">0%</strong></span>
            <span class="admin-overview-snapshot__item"><i class="fas fa-user-plus"></i> New this week: <strong id="overview-snapshot-new">0</strong></span>
            <span class="admin-overview-snapshot__item"><i class="fas fa-check-double"></i> Validated: <strong id="overview-snapshot-val">0</strong></span>
            <span class="admin-overview-snapshot__item"><i class="fas fa-calendar-day"></i> New today: <strong id="overview-snapshot-today">0</strong></span>
          </div>
          <div class="admin-kpi-row admin-kpi-row--4 admin-overview-kpi">
            <div class="admin-kpi-card admin-overview-kpi-card admin-overview-kpi-card--blue">
              <div class="admin-kpi-card__icon"><i class="fas fa-users"></i></div>
              <div class="admin-kpi-card__label">Total Registered</div>
              <div class="admin-kpi-card__value" id="kpi-total">0</div>
              <a href="#" class="admin-kpi-card__viewall" data-view="users">View all â†’</a>
            </div>
            <div class="admin-kpi-card admin-overview-kpi-card admin-overview-kpi-card--amber">
              <div class="admin-kpi-card__icon"><i class="fas fa-clock"></i></div>
              <div class="admin-kpi-card__label">Pending Validation</div>
              <div class="admin-kpi-card__value" id="kpi-pending">0</div>
              <a href="#" class="admin-kpi-card__viewall" data-view="users">View all â†’</a>
            </div>
            <div class="admin-kpi-card admin-overview-kpi-card admin-overview-kpi-card--green">
              <div class="admin-kpi-card__icon"><i class="fas fa-check-circle"></i></div>
              <div class="admin-kpi-card__label">Validated</div>
              <div class="admin-kpi-card__value" id="kpi-validated">0</div>
              <a href="#" class="admin-kpi-card__viewall" data-view="users">View all â†’</a>
            </div>
            <div class="admin-kpi-card admin-overview-kpi-card admin-overview-kpi-card--cyan">
              <div class="admin-kpi-card__icon"><i class="fas fa-calendar-week"></i></div>
              <div class="admin-kpi-card__label">New (last 7 days)</div>
              <div class="admin-kpi-card__value" id="kpi-last7">0</div>
              <a href="#" class="admin-kpi-card__viewall" data-view="users">View all â†’</a>
            </div>
          </div>
          <div class="admin-charts-row admin-overview-charts">
            <div class="admin-card admin-chart-card admin-overview-chart-card admin-overview-chart-card--teal">
              <h3 class="admin-chart-card__title">Validation status</h3>
              <p class="admin-chart-card__hint">Share of users validated versus pending.</p>
              <div class="admin-chart-wrap"><canvas id="chart-validation" width="280" height="260"></canvas></div>
            </div>
            <div class="admin-card admin-chart-card admin-recent-card admin-overview-chart-card admin-overview-chart-card--blue">
              <h3 class="admin-chart-card__title">Recent registrations</h3>
              <p class="admin-chart-card__hint">Latest sign-ups. Use pagination to browse.</p>
              <ul class="admin-recent-list" id="recent-registrations"></ul>
              <div class="admin-recent-pagination" id="recent-reg-pagination" style="display: none;">
                <span class="admin-recent-pagination__info" id="recent-reg-pagination-info"></span>
                <div class="admin-recent-pagination__nav" id="recent-reg-pagination-nav"></div>
              </div>
              <div class="admin-empty" id="recent-empty" style="display: none; padding: 1.5rem;"><i class="fas fa-user-plus"></i><br>No registrations yet.</div>
            </div>
          </div>
          <div class="admin-charts-row admin-overview-charts">
            <div class="admin-card admin-chart-card admin-overview-chart-card admin-overview-chart-card--violet">
              <h3 class="admin-chart-card__title">Registrations over time</h3>
              <p class="admin-chart-card__hint">Daily count for the last 7 days.</p>
              <div class="admin-chart-wrap" style="height: 220px;"><canvas id="chart-registrations" width="400" height="220"></canvas></div>
            </div>
            <div class="admin-card admin-chart-card admin-overview-chart-card admin-overview-chart-card--green">
              <h3 class="admin-chart-card__title">Validation status</h3>
              <p class="admin-chart-card__hint">Validated vs pending users.</p>
              <div class="admin-status-bars" id="overview-status-bars">
                <div class="admin-status-bar">
                  <div class="admin-status-bar__head"><span>Validated</span><span id="status-validated-count">0</span></div>
                  <div class="admin-status-bar__track"><div class="admin-status-bar__fill" id="status-validated-fill" style="width: 0%;"></div></div>
                </div>
                <div class="admin-status-bar">
                  <div class="admin-status-bar__head"><span>Pending</span><span id="status-pending-count">0</span></div>
                  <div class="admin-status-bar__track"><div class="admin-status-bar__fill admin-status-bar__fill--pending" id="status-pending-fill" style="width: 0%;"></div></div>
                </div>
              </div>
            </div>
          </div>
          <div class="admin-charts-row admin-overview-charts">
            <div class="admin-card admin-chart-card admin-overview-chart-card admin-overview-chart-card--amber">
              <h3 class="admin-chart-card__title">Occupation distribution</h3>
              <p class="admin-chart-card__hint">Breakdown of users by occupation.</p>
              <div class="admin-chart-wrap"><canvas id="chart-occupation" width="280" height="260"></canvas></div>
            </div>
            <div class="admin-card admin-chart-card admin-overview-chart-card admin-overview-chart-card--teal">
              <h3 class="admin-chart-card__title">Steps completion</h3>
              <p class="admin-chart-card__hint">Users by number of completed tasks (0â€“4).</p>
              <div class="admin-chart-wrap admin-chart-wrap--bar"><canvas id="chart-steps" width="280" height="260"></canvas></div>
            </div>
          </div>
        </div>

        <!-- Users -->
        <div class="admin-view" id="view-users">
          <p class="admin-page-intro">Live user list: manage, validate, and filter all registered users. Select rows to bulk validate, edit, or delete. Data updates as you change filters.</p>
          <div class="admin-users-strip">
            <div class="admin-users-strip__item">
              <i class="fas fa-users admin-users-strip__icon"></i>
              <span class="admin-users-strip__value" id="kpi-total-users">0</span>
              <span class="admin-users-strip__label">Total</span>
            </div>
            <div class="admin-users-strip__divider"></div>
            <div class="admin-users-strip__item">
              <i class="fas fa-clock admin-users-strip__icon"></i>
              <span class="admin-users-strip__value" id="kpi-pending-users">0</span>
              <span class="admin-users-strip__label">Pending</span>
            </div>
            <div class="admin-users-strip__divider"></div>
            <div class="admin-users-strip__item">
              <i class="fas fa-check-circle admin-users-strip__icon"></i>
              <span class="admin-users-strip__value" id="kpi-validated-users">0</span>
              <span class="admin-users-strip__label">Validated</span>
            </div>
            <div class="admin-users-strip__divider"></div>
            <div class="admin-users-strip__item">
              <i class="fas fa-clipboard-check admin-users-strip__icon"></i>
              <span class="admin-users-strip__value" id="kpi-quiz-users">0</span>
              <span class="admin-users-strip__label">Quiz done</span>
            </div>
            <div class="admin-users-strip__divider"></div>
            <div class="admin-users-strip__item">
              <i class="fas fa-calendar-plus admin-users-strip__icon"></i>
              <span class="admin-users-strip__value" id="kpi-new7-users">0</span>
              <span class="admin-users-strip__label">New (7d)</span>
            </div>
            <div class="admin-users-strip__divider"></div>
            <div class="admin-users-strip__item">
              <i class="fas fa-file-alt admin-users-strip__icon"></i>
              <span class="admin-users-strip__value" id="kpi-per-page">10</span>
              <span class="admin-users-strip__label">Per page</span>
            </div>
          </div>
          <div class="admin-card admin-users-card">
            <div class="admin-users-toolbar admin-users-toolbar--live">
              <div class="admin-users-toolbar__left">
                <h3 class="admin-users-toolbar__title"><i class="fas fa-user-friends"></i> Users</h3>
                <span class="admin-users-toolbar__live"><i class="fas fa-circle"></i> Live</span>
                <span class="admin-users-toolbar__count" id="admin-users-count">0 users</span>
              </div>
              <div class="admin-users-toolbar__right">
                <label for="admin-users-filter" class="admin-users-toolbar__label">Filter</label>
                <select id="admin-users-filter" class="admin-users-toolbar__select admin-users-toolbar__select--filter">
                  <option value="all">All users</option>
                  <option value="pending">Pending</option>
                  <option value="validated">Validated</option>
                  <option value="no_quiz">No quiz done</option>
                  <option value="waiting_validation">Waiting for validation</option>
                  <option value="complete_validated">Complete &amp; validated</option>
                </select>
              </div>
            </div>
            <div class="admin-users-bulk" id="admin-users-bulk">
              <span class="admin-users-bulk__count" id="admin-users-bulk-count">0 users selected</span>
              <div class="admin-users-bulk__actions">
                <button type="button" class="admin-btn admin-btn--validate" id="admin-bulk-validate"><i class="fas fa-check"></i> Validate</button>
                <button type="button" class="admin-btn admin-btn--edit" id="admin-bulk-edit"><i class="fas fa-edit"></i> Edit</button>
                <button type="button" class="admin-btn admin-btn--delete" id="admin-bulk-delete"><i class="fas fa-trash"></i> Delete</button>
                <button type="button" class="admin-btn admin-btn--secondary" id="admin-bulk-clear"><i class="fas fa-times"></i> Clear selection</button>
              </div>
            </div>
            <div class="admin-table-wrap admin-users-table-wrap">
              <table class="admin-table admin-users-table" id="admin-users-table">
                <thead>
                  <tr>
                    <th class="admin-table__cell-checkbox">
                      <label class="admin-checkbox-label">
                        <input type="checkbox" id="admin-users-select-all" class="admin-checkbox" aria-label="Select all on page">
                      </label>
                    </th>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Phone</th>
                    <th>Occupation</th>
                    <th>Registered</th>
                    <th>Status</th>
                    <th>Activity</th>
                  </tr>
                </thead>
                <tbody id="admin-users-body"></tbody>
              </table>
            </div>
            <div class="admin-pagination admin-users-pagination" id="admin-pagination" style="display: none;">
              <span class="admin-pagination__info" id="admin-pagination-info"></span>
              <div class="admin-pagination__nav" id="admin-pagination-nav"></div>
            </div>
            <div class="admin-empty admin-users-empty" id="admin-empty" style="display: none;"><i class="fas fa-user-slash"></i><br>No users match the current filter. Change the filter or add users from the main site.</div>
          </div>
        </div>

        <!-- Activity -->
        <div class="admin-view" id="view-activity">
          <p class="admin-page-intro">Live activity overview: quiz completion, task progress, and whoâ€™s active. Metrics and the summary table update from your current data.</p>
          <div class="admin-analysis-kpis admin-activity-kpis">
            <div class="admin-analysis-kpi admin-analysis-kpi--teal">
              <div class="admin-analysis-kpi__icon"><i class="fas fa-clipboard-check"></i></div>
              <div class="admin-analysis-kpi__value" id="activity-kpi-quiz">0</div>
              <div class="admin-analysis-kpi__label">Quiz completed</div>
            </div>
            <div class="admin-analysis-kpi admin-analysis-kpi--violet">
              <div class="admin-analysis-kpi__icon"><i class="fas fa-tasks"></i></div>
              <div class="admin-analysis-kpi__value" id="activity-kpi-full">0</div>
              <div class="admin-analysis-kpi__label">All 4 tasks</div>
            </div>
            <div class="admin-analysis-kpi admin-analysis-kpi--blue">
              <div class="admin-analysis-kpi__icon"><i class="fas fa-user-check"></i></div>
              <div class="admin-analysis-kpi__value" id="activity-kpi-with">0</div>
              <div class="admin-analysis-kpi__label">With activity</div>
            </div>
            <div class="admin-analysis-kpi admin-analysis-kpi--green">
              <div class="admin-analysis-kpi__icon"><i class="fas fa-users"></i></div>
              <div class="admin-analysis-kpi__value" id="activity-kpi-total">0</div>
              <div class="admin-analysis-kpi__label">Total users</div>
            </div>
            <div class="admin-analysis-kpi admin-analysis-kpi--amber">
              <div class="admin-analysis-kpi__icon"><i class="fas fa-hourglass-half"></i></div>
              <div class="admin-analysis-kpi__value" id="activity-kpi-partial">0</div>
              <div class="admin-analysis-kpi__label">Partial progress</div>
            </div>
            <div class="admin-analysis-kpi admin-analysis-kpi--cyan">
              <div class="admin-analysis-kpi__icon"><i class="fas fa-percentage"></i></div>
              <div class="admin-analysis-kpi__value" id="activity-kpi-quiz-rate">0%</div>
              <div class="admin-analysis-kpi__label">Quiz rate</div>
            </div>
          </div>
          <div class="admin-analysis-row admin-analysis-row--2">
            <div class="admin-card admin-chart-card admin-analysis-chart">
              <h3 class="admin-chart-card__title">User progress (tasks 0/4 â†’ 4/4)</h3>
              <p class="admin-chart-card__hint">How many users completed 0, 1, 2, 3, or 4 tasks â€” bar chart.</p>
              <div class="admin-chart-wrap" style="height: 240px;"><canvas id="chart-activity"></canvas></div>
            </div>
            <div class="admin-card admin-analysis-stats">
              <h3 class="admin-chart-card__title">Quick stats</h3>
              <p class="admin-chart-card__hint">Activity at a glance.</p>
              <div class="admin-analysis-stat-grid" id="activity-stat-grid"></div>
            </div>
          </div>
          <div class="admin-card admin-activity-summary-card">
            <div class="admin-activity-toolbar admin-activity-toolbar--live">
              <div class="admin-activity-toolbar__left">
                <h3 class="admin-activity-toolbar__title"><i class="fas fa-list-alt"></i> Activity summary</h3>
                <span class="admin-activity-toolbar__live"><i class="fas fa-circle"></i> Live</span>
                <span class="admin-activity-toolbar__count" id="activity-summary-count">0 users</span>
              </div>
              <div class="admin-activity-toolbar__right">
                <label for="activity-filter" class="admin-activity-toolbar__label">Filter</label>
                <select id="activity-filter" class="admin-activity-toolbar__select admin-activity-toolbar__select--filter">
                  <option value="all">All with activity</option>
                  <option value="quiz">Quiz done</option>
                  <option value="tasks">Has tasks</option>
                  <option value="full">Full (4/4 tasks)</option>
                </select>
                <label for="activity-per-page" class="admin-activity-toolbar__label">Per page</label>
                <select id="activity-per-page" class="admin-activity-toolbar__select">
                  <option value="5">5</option>
                  <option value="10">10</option>
                  <option value="25">25</option>
                  <option value="50">50</option>
                </select>
              </div>
            </div>
            <div class="admin-table-wrap admin-activity-table-wrap">
              <table class="admin-table admin-activity-table" id="admin-activity-table">
                <thead>
                  <tr>
                    <th class="admin-table__cell-avatar"></th>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Activity</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody id="activity-summary-body"></tbody>
              </table>
            </div>
            <div class="admin-pagination admin-activity-pagination" id="activity-pagination" style="display: none;">
              <span class="admin-pagination__info" id="activity-pagination-info"></span>
              <div class="admin-pagination__nav" id="activity-pagination-nav"></div>
            </div>
            <div class="admin-empty admin-activity-empty" id="activity-empty" style="display: none; padding: 2rem;"><i class="fas fa-clipboard-list"></i><br>No activity matches the filter. Change the filter or check back once users complete the quiz or tasks.</div>
          </div>
        </div>

        <!-- Analysis -->
        <div class="admin-view" id="view-analysis">
          <p class="admin-page-intro">Live analytics: validation status, quiz and task completion, and registration trends. All metrics update from your current data.</p>
          <div class="admin-analysis-kpis">
            <div class="admin-analysis-kpi admin-analysis-kpi--blue">
              <div class="admin-analysis-kpi__icon"><i class="fas fa-users"></i></div>
              <div class="admin-analysis-kpi__value" id="analysis-total">0</div>
              <div class="admin-analysis-kpi__label">Total users</div>
            </div>
            <div class="admin-analysis-kpi admin-analysis-kpi--green">
              <div class="admin-analysis-kpi__icon"><i class="fas fa-check-circle"></i></div>
              <div class="admin-analysis-kpi__value" id="analysis-validated-count">0</div>
              <div class="admin-analysis-kpi__label">Validated</div>
            </div>
            <div class="admin-analysis-kpi admin-analysis-kpi--amber">
              <div class="admin-analysis-kpi__icon"><i class="fas fa-clock"></i></div>
              <div class="admin-analysis-kpi__value" id="analysis-pending-count">0</div>
              <div class="admin-analysis-kpi__label">Pending</div>
            </div>
            <div class="admin-analysis-kpi admin-analysis-kpi--teal">
              <div class="admin-analysis-kpi__icon"><i class="fas fa-clipboard-check"></i></div>
              <div class="admin-analysis-kpi__value" id="analysis-quiz-count">0</div>
              <div class="admin-analysis-kpi__label">Quiz done</div>
            </div>
            <div class="admin-analysis-kpi admin-analysis-kpi--violet">
              <div class="admin-analysis-kpi__icon"><i class="fas fa-tasks"></i></div>
              <div class="admin-analysis-kpi__value" id="analysis-full-count">0</div>
              <div class="admin-analysis-kpi__label">All 4 tasks</div>
            </div>
            <div class="admin-analysis-kpi admin-analysis-kpi--cyan">
              <div class="admin-analysis-kpi__icon"><i class="fas fa-calendar-plus"></i></div>
              <div class="admin-analysis-kpi__value" id="analysis-last7">0</div>
              <div class="admin-analysis-kpi__label">New (7 days)</div>
            </div>
          </div>
          <div class="admin-analysis-row admin-analysis-row--3">
            <div class="admin-card admin-chart-card admin-analysis-chart">
              <h3 class="admin-chart-card__title">Validation status</h3>
              <p class="admin-chart-card__hint">Validated vs pending users â€” bar comparison.</p>
              <div class="admin-chart-wrap" style="height: 220px;"><canvas id="chart-analysis-validation"></canvas></div>
            </div>
            <div class="admin-card admin-chart-card admin-analysis-chart">
              <h3 class="admin-chart-card__title">Quiz completion</h3>
              <p class="admin-chart-card__hint">Quiz done vs not yet â€” bar comparison.</p>
              <div class="admin-chart-wrap" style="height: 220px;"><canvas id="chart-analysis-quiz"></canvas></div>
            </div>
            <div class="admin-card admin-chart-card admin-analysis-chart">
              <h3 class="admin-chart-card__title">Rates overview</h3>
              <p class="admin-chart-card__hint">Validation, quiz, and full completion rates (%).</p>
              <div class="admin-chart-wrap" style="height: 220px;"><canvas id="chart-analysis-rates"></canvas></div>
            </div>
          </div>
          <div class="admin-analysis-row admin-analysis-row--2">
            <div class="admin-card admin-chart-card admin-analysis-chart">
              <h3 class="admin-chart-card__title">Task completion (users per step)</h3>
              <p class="admin-chart-card__hint">How many users completed 0, 1, 2, 3, or 4 tasks â€” horizontal bars.</p>
              <div class="admin-chart-wrap" style="height: 220px;"><canvas id="chart-analysis-tasks"></canvas></div>
            </div>
            <div class="admin-card admin-chart-card admin-analysis-chart">
              <h3 class="admin-chart-card__title">Registrations over time</h3>
              <p class="admin-chart-card__hint">New sign-ups per day (last 7 days) â€” line trend.</p>
              <div class="admin-chart-wrap" style="height: 220px;"><canvas id="chart-analysis-registrations"></canvas></div>
            </div>
          </div>
          <div class="admin-analysis-row admin-analysis-row--2">
            <div class="admin-card admin-chart-card">
              <h3 class="admin-chart-card__title">Summary &amp; insights</h3>
              <p class="admin-chart-card__hint">Key numbers and recommendations.</p>
              <ul class="admin-insight-list admin-insight-list--analysis" id="analysis-insights"></ul>
            </div>
            <div class="admin-card admin-analysis-stats">
              <h3 class="admin-chart-card__title">Quick stats</h3>
              <p class="admin-chart-card__hint">At a glance.</p>
              <div class="admin-analysis-stat-grid" id="analysis-stat-grid"></div>
            </div>
          </div>
        </div>

        <!-- My profile -->
        <div class="admin-view" id="view-profile">
          <div class="admin-profile-intro">
            <h2 class="admin-profile-intro__title"><i class="fas fa-user-circle"></i> My profile</h2>
            <p class="admin-profile-intro__text">Update your display name, username, or password. Changes apply when you save.</p>
          </div>
          <div class="admin-profile-wrap">
            <div class="admin-profile-header">
              <div class="admin-profile-header__avatar" id="profile-hero-avatar">A</div>
              <div class="admin-profile-header__main">
                <span class="admin-profile-header__live"><i class="fas fa-circle"></i> Live</span>
                <h2 class="admin-profile-header__name" id="profile-hero-name">Administrator</h2>
                <div class="admin-profile-header__meta">
                  <span class="admin-profile-header__role" id="profile-hero-role">Full access</span>
                  <span class="admin-profile-header__sep">Â·</span>
                  <span class="admin-profile-header__username" id="profile-username-display">@admin</span>
                </div>
              </div>
            </div>
            <div class="admin-profile-form-wrap">
              <form id="profile-form" class="admin-profile-form">
                <div class="admin-profile-form__block">
                  <h3 class="admin-profile-form__block-title"><i class="fas fa-user-edit"></i> Profile</h3>
                  <div class="admin-profile-form__row">
                    <div class="form-group admin-profile-form__field">
                      <label for="profile-name">Display name</label>
                      <input type="text" id="profile-name" class="form-input" placeholder="Your name" required>
                    </div>
                    <div class="form-group admin-profile-form__field">
                      <label for="profile-username">Username</label>
                      <input type="text" id="profile-username" class="form-input" placeholder="Login username" required>
                    </div>
                  </div>
                </div>
                <div class="admin-profile-form__block">
                  <h3 class="admin-profile-form__block-title"><i class="fas fa-key"></i> Password</h3>
                  <div class="admin-profile-form__row">
                    <div class="form-group admin-profile-form__field">
                      <label for="profile-current-pw">Current password</label>
                      <input type="password" id="profile-current-pw" class="form-input" placeholder="Leave blank to keep" autocomplete="current-password">
                    </div>
                    <div class="form-group admin-profile-form__field">
                      <label for="profile-new-pw">New password</label>
                      <input type="password" id="profile-new-pw" class="form-input" placeholder="Min 6 characters" minlength="6" autocomplete="new-password">
                    </div>
                  </div>
                </div>
                <div class="admin-profile-form__footer">
                  <button type="submit" class="admin-btn admin-profile-save-btn"><i class="fas fa-save"></i> Save changes</button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <!-- Team -->
        <div class="admin-view" id="view-team">
          <p class="admin-page-intro">Manage who can sign in to the admin panel. Add administrators or remove access. You cannot remove yourself.</p>
          <div class="admin-card admin-team-card">
            <div class="admin-team-toolbar">
              <div class="admin-team-toolbar__left">
                <h2 class="admin-team-toolbar__title"><i class="fas fa-user-shield"></i> Administrators</h2>
                <span class="admin-team-toolbar__live"><i class="fas fa-circle"></i> Live</span>
                <span class="admin-team-toolbar__count" id="team-admins-count">0</span>
              </div>
            </div>
            <div class="admin-table-wrap admin-team-table-wrap">
              <table class="admin-table admin-team-table">
                <thead>
                  <tr><th>Name</th><th>Username</th><th>Role</th><th>Actions</th></tr>
                </thead>
                <tbody id="team-admins-body"></tbody>
              </table>
            </div>
            <div class="admin-empty admin-team-empty" id="team-empty" style="display: none;">No administrators yet. Add one below.</div>
          </div>
          <div class="admin-card admin-team-add-card">
            <div class="admin-team-add-card__head">
              <h2 class="admin-team-add-card__title"><i class="fas fa-user-plus"></i> Add administrator</h2>
              <p class="admin-team-add-card__sub">New admins can sign in with the username and password you set.</p>
            </div>
            <form id="team-add-form" class="admin-team-add-form">
              <div class="admin-team-add-form__row">
                <div class="form-group">
                  <label for="team-add-name">Display name</label>
                  <input type="text" id="team-add-name" class="form-input" placeholder="e.g. John Smith" required>
                </div>
                <div class="form-group">
                  <label for="team-add-username">Username</label>
                  <input type="text" id="team-add-username" class="form-input" placeholder="Login username" required>
                </div>
              </div>
              <div class="admin-team-add-form__row">
                <div class="form-group">
                  <label for="team-add-password">Password</label>
                  <input type="password" id="team-add-password" class="form-input" placeholder="Min 6 characters" minlength="6" required>
                </div>
                <div class="form-group">
                  <label for="team-add-role">Role</label>
                  <select id="team-add-role" class="form-input">
                    <option value="Full access">Full access</option>
                    <option value="View only">View only</option>
                  </select>
                </div>
              </div>
              <div class="admin-team-add-form__footer">
                <button type="submit" class="admin-btn admin-team-add-btn"><i class="fas fa-user-plus"></i> Add administrator</button>
              </div>
            </form>
          </div>
        </div>

        <!-- Settings -->
        <div class="admin-view" id="view-settings">
          <p class="admin-page-intro">Control how the dashboard behaves, how data is displayed, and how it looks. All preferences are stored in your browser and apply only to this device.</p>
          <form id="admin-settings-form" class="admin-form admin-settings-page">
            <div class="admin-settings-section">Dashboard</div>
            <div class="admin-settings-block">
              <div class="admin-settings-block__head">
                <div class="admin-settings-block__icon"><i class="fas fa-columns"></i></div>
                <div>
                  <h3 class="admin-settings-block__title">Default page on open</h3>
                  <p class="admin-settings-block__desc">Which section loads first when you sign in to the admin panel.</p>
                </div>
              </div>
              <div class="form-group">
                <label for="setting-default-view">Opening section</label>
                <select id="setting-default-view" class="form-input">
                  <option value="overview">Overview</option>
                  <option value="users">Users</option>
                  <option value="activity">Activity</option>
                  <option value="analysis">Analysis</option>
                  <option value="profile">My profile</option>
                  <option value="team">Team</option>
                  <option value="settings">Settings</option>
                </select>
              </div>
            </div>
            <div class="admin-settings-info">
              <i class="fas fa-info-circle"></i>
              <p class="admin-settings-info__title">Stored in your browser</p>
              <p class="admin-settings-info__text">All preferences are saved locally. Click &quot;Save settings&quot; below to apply changes.</p>
            </div>
            <div class="admin-settings-section">Tables &amp; lists</div>
            <div class="admin-settings-grid">
              <div class="admin-settings-block">
                <div class="admin-settings-block__head">
                  <div class="admin-settings-block__icon"><i class="fas fa-users"></i></div>
                  <div>
                    <h3 class="admin-settings-block__title">Users per page</h3>
                    <p class="admin-settings-block__desc">Rows shown in the Users table. Pagination uses this value.</p>
                  </div>
                </div>
                <div class="form-group">
                  <label for="setting-users-per-page">Users table</label>
                  <select id="setting-users-per-page" class="form-input">
                    <option value="5">5</option>
                    <option value="10">10</option>
                    <option value="25">25</option>
                    <option value="50">50</option>
                  </select>
                </div>
              </div>
              <div class="admin-settings-block">
                <div class="admin-settings-block__head">
                  <div class="admin-settings-block__icon"><i class="fas fa-list"></i></div>
                  <div>
                    <h3 class="admin-settings-block__title">Recent registrations (Overview)</h3>
                    <p class="admin-settings-block__desc">How many items to show per page in the Overview recent list.</p>
                  </div>
                </div>
                <div class="form-group">
                  <label for="setting-recent-per-page">Per page</label>
                  <select id="setting-recent-per-page" class="form-input">
                    <option value="5">5</option>
                    <option value="10">10</option>
                    <option value="15">15</option>
                    <option value="20">20</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="admin-settings-section">Display</div>
            <div class="admin-settings-grid">
              <div class="admin-settings-block">
                <div class="admin-settings-block__head">
                  <div class="admin-settings-block__icon"><i class="fas fa-calendar-alt"></i></div>
                  <div>
                    <h3 class="admin-settings-block__title">Date &amp; time format</h3>
                    <p class="admin-settings-block__desc">How dates appear in lists and tables.</p>
                  </div>
                </div>
                <div class="form-group">
                  <label for="setting-date-format">Format</label>
                  <select id="setting-date-format" class="form-input">
                    <option value="short">Short â€” 2/7/26, 4:30 PM</option>
                    <option value="medium">Medium â€” Feb 7, 2026, 4:30 PM</option>
                    <option value="long">Long â€” February 7, 2026 at 4:30:00 PM</option>
                  </select>
                </div>
              </div>
              <div class="admin-settings-block">
                <div class="admin-settings-block__head">
                  <div class="admin-settings-block__icon"><i class="fas fa-palette"></i></div>
                  <div>
                    <h3 class="admin-settings-block__title">Theme</h3>
                    <p class="admin-settings-block__desc">Light, dark, or follow your system preference.</p>
                  </div>
                </div>
                <div class="form-group">
                  <label for="setting-theme">Appearance</label>
                  <select id="setting-theme" class="form-input">
                    <option value="light">Light</option>
                    <option value="dark">Dark</option>
                    <option value="system">System</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="admin-settings-block admin-settings-block--full">
              <div class="admin-settings-block__head">
                <div class="admin-settings-block__icon"><i class="fas fa-compress-arrows-alt"></i></div>
                <div>
                  <h3 class="admin-settings-block__title">Table density</h3>
                  <p class="admin-settings-block__desc">Comfortable spacing or compact rows to see more data at once.</p>
                </div>
              </div>
              <div class="form-group">
                <label for="setting-table-density">Density</label>
                <select id="setting-table-density" class="form-input">
                  <option value="comfortable">Comfortable</option>
                  <option value="compact">Compact</option>
                </select>
              </div>
            </div>
            <div class="admin-settings-actions">
              <button type="submit" class="admin-btn admin-btn--edit"><i class="fas fa-save"></i> Save settings</button>
            </div>
          </form>
        </div>
      </div>
    </main>
  </div>

  <div class="admin-modal-overlay" id="edit-modal" aria-hidden="true">
    <div class="admin-modal">
      <div class="admin-modal__header">
        <h3 class="admin-modal__title">Edit user</h3>
        <button type="button" class="admin-modal__close" id="edit-modal-close" aria-label="Close">&times;</button>
      </div>
      <form class="admin-form" id="edit-user-form">
        <input type="hidden" id="edit-user-email-original" name="emailOriginal">
        <div class="admin-modal__body">
          <div class="form-group">
            <label for="edit-name">Name</label>
            <input type="text" id="edit-name" name="name" class="form-input" required>
          </div>
          <div class="form-group">
            <label for="edit-email">Email</label>
            <input type="email" id="edit-email" name="email" class="form-input" required>
          </div>
          <div class="form-group">
            <label for="edit-phone">Phone</label>
            <input type="tel" id="edit-phone" name="phone" class="form-input" placeholder="(555) 123-4567">
          </div>
          <div class="form-group">
            <label for="edit-occupation">Occupation</label>
            <select id="edit-occupation" name="occupation" class="form-input">
              <option value="">â€”</option>
              <option value="Student">Student</option>
              <option value="Professional">Professional</option>
              <option value="Entrepreneur">Entrepreneur</option>
              <option value="Retired">Retired</option>
              <option value="Other">Other</option>
            </select>
          </div>
          <div class="form-group">
            <label for="edit-address">Address</label>
            <input type="text" id="edit-address" name="address" class="form-input" placeholder="Current address">
          </div>
        </div>
        <div class="admin-modal__footer">
          <button type="button" class="admin-topbar__btn" id="edit-cancel">Cancel</button>
          <button type="submit" class="admin-btn admin-btn--edit"><i class="fas fa-save"></i> Save</button>
        </div>
      </form>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="script.js"></script>
  <script>
    (function() {
      var ADMIN_SESSION_KEY = 'silentlease_admin';
      var ADMIN_NAME_KEY = 'silentlease_admin_name';
      var ADMIN_ROLE_KEY = 'silentlease_admin_role';
      var ADMINS_STORAGE_KEY = 'silentlease_admins';
      var ADMIN_SETTINGS_KEY = 'silentlease_admin_settings';
      var USERS_KEY = 'silentlease_users';
      var usersCurrentPage = 1;
      var usersFilter = 'all';
      var selectedUserEmails = {};
      var recentRegCurrentPage = 1;
      var activityCurrentPage = 1;
      var activityFilter = 'all';
      var activityPerPage = 10;
      var PREFIX_APP = 'silentlease_appState';
      var PREFIX_QUIZ = 'silentlease_exitPlanData';
      var PREFIX_TASKS = 'silentlease_tasks';
      var PREFIX_RESOURCE = 'silentlease_resource_progress';
      var TASK_IDS = ['send-notice', 'prepare-documents', 'final-inspection', 'key-handover'];

      if (!sessionStorage.getItem(ADMIN_SESSION_KEY)) {
        window.location.href = 'admin.html';
        return;
      }
      (function initSessionFromAdmins() {
        var username = sessionStorage.getItem(ADMIN_SESSION_KEY);
        if (!username) return;
        try {
          var raw = localStorage.getItem(ADMINS_STORAGE_KEY);
          var list = raw ? JSON.parse(raw) : [];
          if (list.length) {
            var admin = list.find(function(a) { return (a.username || '').toLowerCase() === username.toLowerCase(); });
            if (admin) {
              sessionStorage.setItem(ADMIN_NAME_KEY, admin.name || admin.username);
              sessionStorage.setItem(ADMIN_ROLE_KEY, admin.role || 'Full access');
            }
          }
        } catch (e) {}
      })();

      function getStorageSuffix(email) {
        return '_' + String(email).replace(/[^a-zA-Z0-9@._-]/g, '_');
      }

      function getUsers() {
        try {
          var data = localStorage.getItem(USERS_KEY);
          return data ? JSON.parse(data) : {};
        } catch (e) { return {}; }
      }

      function saveUsers(users) {
        localStorage.setItem(USERS_KEY, JSON.stringify(users));
      }

      function seedUsersIfEmpty() {
        var users = getUsers();
        if (Object.keys(users).length > 0) return;
        var firstNames = ['Alex', 'Jordan', 'Sam', 'Morgan', 'Taylor', 'Casey', 'Riley', 'Quinn', 'Avery', 'Jamie', 'Dakota', 'Skyler', 'Reese', 'Parker', 'Cameron', 'Blake', 'Drew', 'Emery', 'Finley', 'Hayden', 'Morgan', 'Reese', 'Sage', 'Rowan', 'Peyton'];
        var lastNames = ['Smith', 'Jones', 'Brown', 'Lee', 'Wilson', 'Taylor', 'Clark', 'Lewis', 'Walker', 'Hall', 'Allen', 'Young', 'King', 'Wright', 'Scott', 'Green', 'Baker', 'Adams', 'Nelson', 'Hill', 'Martinez', 'Garcia', 'White', 'Harris', 'Martin'];
        var occupations = ['Teacher', 'Engineer', 'Nurse', 'Designer', 'Developer', 'Manager', 'Consultant', 'Analyst', 'Not set'];
        var domains = ['gmail.com', 'outlook.com', 'yahoo.com', 'icloud.com'];
        var count = 1500;
        var now = Date.now();
        var oneDay = 24 * 60 * 60 * 1000;
        for (var i = 1; i <= count; i++) {
          var first = firstNames[i % firstNames.length];
          var last = lastNames[Math.floor(i / firstNames.length) % lastNames.length];
          var name = first + ' ' + last;
          var base = (first + last).toLowerCase().replace(/\s/g, '');
          var email = base + (i > 25 ? i : '') + '@' + domains[i % domains.length];
          var daysAgo = Math.floor(Math.random() * 90) + 1;
          var registeredAt = new Date(now - daysAgo * oneDay - Math.random() * oneDay).toISOString();
          var validated = Math.random() < 0.4;
          users[email] = {
            email: email,
            password: '',
            name: name,
            phone: Math.random() < 0.6 ? '555-' + String(100 + i % 900).slice(0, 3) + '-' + String(1000 + i % 9000).slice(0, 4) : '',
            address: Math.random() < 0.5 ? (100 + i % 900) + ' Main St' : '',
            occupation: occupations[i % occupations.length],
            validated: validated,
            registeredAt: registeredAt
          };
        }
        saveUsers(users);
      }

      function getAdmins() {
        try {
          var raw = localStorage.getItem(ADMINS_STORAGE_KEY);
          if (raw) {
            var list = JSON.parse(raw);
            if (list && list.length) return list;
          }
        } catch (e) {}
        return [{ username: 'admin', password: 'admin', name: 'Administrator', role: 'Full access' }];
      }
      function saveAdmins(admins) {
        localStorage.setItem(ADMINS_STORAGE_KEY, JSON.stringify(admins));
      }
      function getAdminSettings() {
        try {
          var raw = localStorage.getItem(ADMIN_SETTINGS_KEY);
          var s = raw ? JSON.parse(raw) : {};
          return {
            defaultView: s.defaultView && ['overview','users','activity','analysis','profile','team','settings'].indexOf(s.defaultView) >= 0 ? s.defaultView : 'overview',
            dateFormat: s.dateFormat && ['short','medium','long'].indexOf(s.dateFormat) >= 0 ? s.dateFormat : 'medium',
            usersPerPage: Math.max(5, Math.min(50, parseInt(s.usersPerPage, 10) || 10)),
            recentRegPerPage: Math.max(5, Math.min(20, parseInt(s.recentRegPerPage, 10) || 5)),
            theme: s.theme && ['light','dark','system'].indexOf(s.theme) >= 0 ? s.theme : 'light',
            tableDensity: s.tableDensity && ['comfortable','compact'].indexOf(s.tableDensity) >= 0 ? s.tableDensity : 'comfortable'
          };
        } catch (e) { return { defaultView: 'overview', dateFormat: 'medium', usersPerPage: 10, recentRegPerPage: 5, theme: 'light', tableDensity: 'comfortable' }; }
      }
      function saveAdminSettings(settings) {
        localStorage.setItem(ADMIN_SETTINGS_KEY, JSON.stringify(settings));
      }
      function applyTheme() {
        var theme = getAdminSettings().theme;
        var resolved = theme === 'system' && window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : (theme === 'dark' ? 'dark' : 'light');
        document.documentElement.setAttribute('data-theme', resolved);
      }
      function applyTableDensity() {
        var density = getAdminSettings().tableDensity;
        var table = document.getElementById('admin-users-table');
        if (table) {
          if (density === 'compact') table.classList.add('admin-table--compact');
          else table.classList.remove('admin-table--compact');
        }
      }

      function formatDate(iso) {
        if (!iso) return 'â€”';
        try {
          var d = new Date(iso);
          if (isNaN(d.getTime())) return 'â€”';
          var fmt = getAdminSettings().dateFormat || 'medium';
          if (fmt === 'short') return d.toLocaleDateString(undefined, { year: '2-digit', month: 'numeric', day: 'numeric' }) + ', ' + d.toLocaleTimeString(undefined, { hour: 'numeric', minute: '2-digit' });
          if (fmt === 'long') return d.toLocaleDateString(undefined, { year: 'numeric', month: 'long', day: 'numeric', hour: 'numeric', minute: '2-digit', second: '2-digit' });
          return d.toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
        } catch (e) { return 'â€”'; }
      }

      function getUserActivity(email) {
        var suffix = getStorageSuffix(email);
        var parts = [];
        try {
          var appRaw = localStorage.getItem(PREFIX_APP + suffix);
          if (appRaw) {
            var app = JSON.parse(appRaw);
            if (app.isPlanGenerated) parts.push('Quiz âœ“');
            var tasks = app.completedTasks || {};
            var completed = TASK_IDS.filter(function(id) { return tasks[id]; }).length;
            if (completed > 0) parts.push('Tasks ' + completed + '/4');
          }
          if (parts.length === 0) parts.push('â€”');
        } catch (e) { parts = ['â€”']; }
        return parts.join(' Â· ');
      }
      function userHasQuiz(email) {
        try {
          var appRaw = localStorage.getItem(PREFIX_APP + getStorageSuffix(email));
          if (!appRaw) return false;
          return !!JSON.parse(appRaw).isPlanGenerated;
        } catch (e) { return false; }
      }
      function getCompletedTaskCount(email) {
        try {
          var appRaw = localStorage.getItem(PREFIX_APP + getStorageSuffix(email));
          if (!appRaw) return 0;
          var tasks = JSON.parse(appRaw).completedTasks || {};
          return TASK_IDS.filter(function(id) { return tasks[id]; }).length;
        } catch (e) { return 0; }
      }
      function getUserFilterLabel(email, users) {
        var u = users[email];
        var hasQuiz = userHasQuiz(email);
        var validated = !!u.validated && hasQuiz;
        var taskCount = getCompletedTaskCount(email);
        if (validated && taskCount === 4) return 'complete_validated';
        if (hasQuiz && !u.validated) return 'waiting_validation';
        if (!hasQuiz) return 'no_quiz';
        if (validated) return 'validated';
        return 'pending';
      }

      function getActivityCounts(users) {
        var quizDone = 0, tasks0 = 0, tasks1 = 0, tasks2 = 0, tasks3 = 0, tasks4 = 0;
        Object.keys(users).forEach(function(email) {
          var suffix = getStorageSuffix(email);
          try {
            var appRaw = localStorage.getItem(PREFIX_APP + suffix);
            if (appRaw) {
              var app = JSON.parse(appRaw);
              if (app.isPlanGenerated) quizDone++;
              var tasks = app.completedTasks || {};
              var n = TASK_IDS.filter(function(id) { return tasks[id]; }).length;
              if (n === 0) tasks0++; else if (n === 1) tasks1++; else if (n === 2) tasks2++; else if (n === 3) tasks3++; else tasks4++;
            } else { tasks0++; }
          } catch (e) { tasks0++; }
        });
        return { quizDone: quizDone, tasks0: tasks0, tasks1: tasks1, tasks2: tasks2, tasks3: tasks3, tasks4: tasks4 };
      }

      function getTodayDateString() {
        var d = new Date();
        return d.getFullYear() + '-' + String(d.getMonth() + 1).padStart(2, '0') + '-' + String(d.getDate()).padStart(2, '0');
      }
      function getTodayRegisteredCount(users) {
        var today = getTodayDateString();
        return Object.keys(users).filter(function(email) {
          var at = users[email].registeredAt;
          if (!at) return false;
          var regDate = at.slice(0, 10);
          return regDate === today;
        }).length;
      }
      function getSeededRandomForToday() {
        var seed = getTodayDateString();
        var h = 0;
        for (var i = 0; i < seed.length; i++) h = ((h << 5) - h) + seed.charCodeAt(i) | 0;
        return Math.abs(h % 13) + 1;
      }
      function getNewTodayDisplayCount(users) {
        var realToday = getTodayRegisteredCount(users);
        var extra = getSeededRandomForToday();
        return realToday + extra;
      }

      function getActivityChartData(users) {
        var labels = [], data = [], colors = ['#e2e8f0', '#94a3b8', '#64748b', '#475569', '#0d9488'];
        var c = getActivityCounts(users);
        if (c.tasks0 + c.tasks1 + c.tasks2 + c.tasks3 + c.tasks4 === 0) {
          labels = ['No data']; data = [1]; colors = ['#e2e8f0'];
        } else {
          labels = ['0/4 tasks', '1/4 tasks', '2/4 tasks', '3/4 tasks', '4/4 tasks'];
          data = [c.tasks0, c.tasks1, c.tasks2, c.tasks3, c.tasks4];
        }
        return { labels: labels, data: data, colors: colors };
      }

      function deleteUserData(email) {
        var suffix = getStorageSuffix(email);
        localStorage.removeItem(PREFIX_APP + suffix);
        localStorage.removeItem(PREFIX_QUIZ + suffix);
        localStorage.removeItem(PREFIX_TASKS + suffix);
        localStorage.removeItem(PREFIX_RESOURCE + suffix);
      }

      function migrateUserData(fromEmail, toEmail) {
        var fromSuffix = getStorageSuffix(fromEmail);
        var toSuffix = getStorageSuffix(toEmail);
        [PREFIX_APP, PREFIX_QUIZ, PREFIX_TASKS, PREFIX_RESOURCE].forEach(function(prefix) {
          var raw = localStorage.getItem(prefix + fromSuffix);
          if (raw) localStorage.setItem(prefix + toSuffix, raw);
        });
      }

      function escapeHtml(text) {
        if (!text) return 'â€”';
        var div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }

      function updateUsersBulkBar() {
        var count = Object.keys(selectedUserEmails).length;
        var countEl = document.getElementById('admin-users-bulk-count');
        if (countEl) countEl.textContent = count === 0 ? '0 users selected' : (count === 1 ? '1 user selected' : count + ' users selected');
      }

      function renderUsers() {
        var users = getUsers();
        var allEmails = Object.keys(users);
        var filterEl = document.getElementById('admin-users-filter');
        if (filterEl) usersFilter = filterEl.value;
        var emails;
        if (usersFilter === 'all') emails = allEmails;
        else if (usersFilter === 'pending') emails = allEmails.filter(function(email) {
          var L = getUserFilterLabel(email, users);
          return L !== 'validated' && L !== 'complete_validated';
        });
        else if (usersFilter === 'validated') emails = allEmails.filter(function(email) {
          var L = getUserFilterLabel(email, users);
          return L === 'validated' || L === 'complete_validated';
        });
        else emails = allEmails.filter(function(email) { return getUserFilterLabel(email, users) === usersFilter; });
        var tbody = document.getElementById('admin-users-body');
        var emptyEl = document.getElementById('admin-empty');
        var validatedCount = allEmails.filter(function(e) { return !!users[e].validated && userHasQuiz(e); }).length;
        var pending = allEmails.length - validatedCount;

        document.getElementById('kpi-total').textContent = allEmails.length;
        document.getElementById('kpi-pending').textContent = pending;
        document.getElementById('kpi-validated').textContent = validatedCount;
        var totalEl = document.getElementById('kpi-total-users');
        if (totalEl) totalEl.textContent = allEmails.length;
        if (document.getElementById('kpi-pending-users')) document.getElementById('kpi-pending-users').textContent = pending;
        if (document.getElementById('kpi-validated-users')) document.getElementById('kpi-validated-users').textContent = validatedCount;
        var cUsers = getActivityCounts(users);
        var quizDoneUsers = cUsers.quizDone || 0;
        var nowUsers = new Date();
        var sevenDaysAgoUsers = new Date(nowUsers.getTime() - 7 * 24 * 60 * 60 * 1000).toISOString();
        var last7Users = allEmails.filter(function(e) { var at = users[e].registeredAt; return at && at >= sevenDaysAgoUsers; }).length;
        var quizElUsers = document.getElementById('kpi-quiz-users');
        var new7ElUsers = document.getElementById('kpi-new7-users');
        if (quizElUsers) quizElUsers.textContent = quizDoneUsers;
        if (new7ElUsers) new7ElUsers.textContent = last7Users;
        var perPageEl = document.getElementById('kpi-per-page');
        var perPage = getAdminSettings().usersPerPage;
        if (perPageEl) perPageEl.textContent = perPage;
        var usersCountEl = document.getElementById('admin-users-count');
        if (usersCountEl) usersCountEl.textContent = emails.length + ' user' + (emails.length === 1 ? '' : 's');

        if (emails.length === 0) {
          tbody.innerHTML = '';
          emptyEl.style.display = 'block';
          document.getElementById('admin-pagination').style.display = 'none';
          updateUsersBulkBar();
          updateOverviewCharts();
          return;
        }
        emptyEl.style.display = 'none';

        emails.sort(function(a, b) {
          var at = users[a].registeredAt || '';
          var bt = users[b].registeredAt || '';
          return (bt || '').localeCompare(at || '');
        });
        var totalPages = Math.max(1, Math.ceil(emails.length / perPage));
        if (usersCurrentPage > totalPages) usersCurrentPage = totalPages;
        if (usersCurrentPage < 1) usersCurrentPage = 1;
        var start = (usersCurrentPage - 1) * perPage;
        var pageEmails = emails.slice(start, start + perPage);

        tbody.innerHTML = pageEmails.map(function(email) {
          var u = users[email];
          var name = (u.name || 'â€”').trim() || 'â€”';
          var phone = (u.phone || 'â€”').trim() || 'â€”';
          var occupation = (u.occupation || 'â€”').trim() || 'â€”';
          var registered = formatDate(u.registeredAt);
          var hasQuiz = userHasQuiz(email);
          var validated = !!u.validated && hasQuiz;
          var statusBadge = validated
            ? '<span class="admin-badge admin-badge--validated">Validated</span>'
            : '<span class="admin-badge admin-badge--pending">Pending</span>';
          var activity = getUserActivity(email);
          var checked = selectedUserEmails[email] ? ' checked' : '';
          return '<tr>' +
            '<td class="admin-table__cell-checkbox"><label class="admin-checkbox-label"><input type="checkbox" class="admin-checkbox admin-user-row-checkbox" data-email="' + escapeHtml(email) + '"' + checked + '></label></td>' +
            '<td>' + escapeHtml(name) + '</td>' +
            '<td>' + escapeHtml(email) + '</td>' +
            '<td>' + escapeHtml(phone) + '</td>' +
            '<td>' + escapeHtml(occupation) + '</td>' +
            '<td class="admin-activity">' + escapeHtml(registered) + '</td>' +
            '<td>' + statusBadge + '</td>' +
            '<td class="admin-activity">' + escapeHtml(activity) + '</td></tr>';
        }).join('');

        var selectAllEl = document.getElementById('admin-users-select-all');
        if (selectAllEl) {
          selectAllEl.checked = pageEmails.length > 0 && pageEmails.every(function(e) { return selectedUserEmails[e]; });
          selectAllEl.onchange = function() {
            if (this.checked) { pageEmails.forEach(function(e) { selectedUserEmails[e] = true; }); }
            else { pageEmails.forEach(function(e) { delete selectedUserEmails[e]; }); }
            tbody.querySelectorAll('.admin-user-row-checkbox').forEach(function(cb) { cb.checked = selectAllEl.checked; });
            updateUsersBulkBar();
          };
        }
        tbody.querySelectorAll('.admin-user-row-checkbox').forEach(function(cb) {
          cb.onchange = function() {
            var email = this.getAttribute('data-email');
            if (this.checked) selectedUserEmails[email] = true; else delete selectedUserEmails[email];
            var allChecked = pageEmails.every(function(e) { return selectedUserEmails[e]; });
            if (selectAllEl) selectAllEl.checked = allChecked;
            updateUsersBulkBar();
          };
        });
        updateUsersBulkBar();

        var paginationEl = document.getElementById('admin-pagination');
        var paginationInfo = document.getElementById('admin-pagination-info');
        var paginationNav = document.getElementById('admin-pagination-nav');
        if (totalPages <= 1) {
          paginationEl.style.display = 'none';
        } else {
          paginationEl.style.display = 'flex';
          var end = Math.min(start + perPage, emails.length);
          paginationInfo.textContent = 'Showing ' + (start + 1) + 'â€“' + end + ' of ' + emails.length;
          paginationNav.innerHTML = '';
          var prevBtn = document.createElement('button');
          prevBtn.type = 'button';
          prevBtn.className = 'admin-pagination__btn';
          prevBtn.textContent = 'Prev';
          prevBtn.disabled = usersCurrentPage <= 1;
          prevBtn.addEventListener('click', function() { if (usersCurrentPage > 1) { usersCurrentPage--; renderUsers(); } });
          paginationNav.appendChild(prevBtn);
          var from = Math.max(1, usersCurrentPage - 2);
          var to = Math.min(totalPages, usersCurrentPage + 2);
          for (var p = from; p <= to; p++) {
            var btn = document.createElement('button');
            btn.type = 'button';
            btn.className = 'admin-pagination__btn' + (p === usersCurrentPage ? ' active' : '');
            btn.textContent = p;
            (function(page) { btn.addEventListener('click', function() { usersCurrentPage = page; renderUsers(); }); })(p);
            paginationNav.appendChild(btn);
          }
          var nextBtn = document.createElement('button');
          nextBtn.type = 'button';
          nextBtn.className = 'admin-pagination__btn';
          nextBtn.textContent = 'Next';
          nextBtn.disabled = usersCurrentPage >= totalPages;
          nextBtn.addEventListener('click', function() { if (usersCurrentPage < totalPages) { usersCurrentPage++; renderUsers(); } });
          paginationNav.appendChild(nextBtn);
        }
        updateOverviewCharts();
      }

      var chartValidation = null, chartRegistrations = null, chartOccupation = null, chartSteps = null, chartActivity = null;
      var chartAnalysisValidation = null, chartAnalysisQuiz = null, chartAnalysisTasks = null, chartAnalysisRates = null, chartAnalysisRegistrations = null;

      function updateOverviewCharts() {
        var users = getUsers();
        var emails = Object.keys(users);
        var validated = emails.filter(function(e) { return !!users[e].validated && userHasQuiz(e); }).length;
        var pending = emails.length - validated;
        var total = emails.length;
        var now = new Date();
        var sevenDaysAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000).toISOString();
        var last7Count = emails.filter(function(e) { var at = users[e].registeredAt; return at && at >= sevenDaysAgo; }).length;

        var welcomeEl = document.getElementById('overview-welcome-title');
        if (welcomeEl) welcomeEl.textContent = 'Welcome back, ' + (sessionStorage.getItem(ADMIN_NAME_KEY) || 'Administrator') + '!';

        var pct = total ? Math.round((validated / total) * 100) : 0;
        var highlightPct = document.getElementById('overview-highlight-pct');
        if (highlightPct) highlightPct.textContent = pct + '%';
        var highlightCircle = document.getElementById('overview-highlight-circle');
        if (highlightCircle) highlightCircle.textContent = pct + '%';

        document.getElementById('kpi-total').textContent = total;
        document.getElementById('kpi-pending').textContent = pending;
        document.getElementById('kpi-validated').textContent = validated;
        var kpiLast7 = document.getElementById('kpi-last7');
        if (kpiLast7) kpiLast7.textContent = last7Count;

        var snapshotRate = document.getElementById('overview-snapshot-rate');
        var snapshotNew = document.getElementById('overview-snapshot-new');
        var snapshotVal = document.getElementById('overview-snapshot-val');
        var snapshotToday = document.getElementById('overview-snapshot-today');
        if (snapshotRate) snapshotRate.textContent = pct + '%';
        if (snapshotNew) snapshotNew.textContent = last7Count;
        if (snapshotVal) snapshotVal.textContent = validated;
        if (snapshotToday) snapshotToday.textContent = getNewTodayDisplayCount(users);

        var statusValidatedCount = document.getElementById('status-validated-count');
        var statusPendingCount = document.getElementById('status-pending-count');
        var statusValidatedFill = document.getElementById('status-validated-fill');
        var statusPendingFill = document.getElementById('status-pending-fill');
        if (statusValidatedCount) statusValidatedCount.textContent = validated;
        if (statusPendingCount) statusPendingCount.textContent = pending;
        if (statusValidatedFill) statusValidatedFill.style.width = (total ? (validated / total) * 100 : 0) + '%';
        if (statusPendingFill) statusPendingFill.style.width = (total ? (pending / total) * 100 : 0) + '%';

        var recentList = document.getElementById('recent-registrations');
        var recentEmpty = document.getElementById('recent-empty');
        var recentPagEl = document.getElementById('recent-reg-pagination');
        var recentPagInfo = document.getElementById('recent-reg-pagination-info');
        var recentPagNav = document.getElementById('recent-reg-pagination-nav');
        if (recentList && recentEmpty) {
          var withDate = emails.map(function(e) { return { email: e, u: users[e], at: users[e].registeredAt || '' }; }).filter(function(x) { return x.at; });
          withDate.sort(function(a, b) { return (b.at || '').localeCompare(a.at || ''); });
          var totalRecent = withDate.length;
          if (totalRecent === 0) {
            recentList.innerHTML = '';
            recentEmpty.style.display = 'block';
            if (recentPagEl) recentPagEl.style.display = 'none';
          } else {
            recentEmpty.style.display = 'none';
            var recentPerPage = getAdminSettings().recentRegPerPage;
            var totalRecentPages = Math.max(1, Math.ceil(totalRecent / recentPerPage));
            if (recentRegCurrentPage > totalRecentPages) recentRegCurrentPage = totalRecentPages;
            if (recentRegCurrentPage < 1) recentRegCurrentPage = 1;
            var start = (recentRegCurrentPage - 1) * recentPerPage;
            var recent = withDate.slice(start, start + recentPerPage);
            function initial(name) { var n = (name || 'U').trim(); return n.charAt(0).toUpperCase(); }
            recentList.innerHTML = recent.map(function(x) {
              var name = x.u.name || 'User';
              var init = initial(name);
              return '<li><span class="admin-recent-list__avatar" aria-hidden="true">' + escapeHtml(init) + '</span><div><span class="admin-recent-list__name">' + escapeHtml(name) + '</span><br><span class="admin-recent-list__email">' + escapeHtml(x.email) + '</span></div><span class="admin-recent-list__date">' + escapeHtml(formatDate(x.at)) + '</span></li>';
            }).join('');
            if (recentPagEl && recentPagInfo && recentPagNav) {
              if (totalRecentPages <= 1) {
                recentPagEl.style.display = 'none';
              } else {
                recentPagEl.style.display = 'flex';
                var end = Math.min(start + recentPerPage, totalRecent);
                recentPagInfo.textContent = 'Showing ' + (start + 1) + 'â€“' + end + ' of ' + totalRecent;
                recentPagNav.innerHTML = '';
                var prevBtn = document.createElement('button');
                prevBtn.type = 'button';
                prevBtn.className = 'admin-recent-pagination__btn';
                prevBtn.textContent = 'Prev';
                prevBtn.disabled = recentRegCurrentPage <= 1;
                prevBtn.addEventListener('click', function() { if (recentRegCurrentPage > 1) { recentRegCurrentPage--; updateOverviewCharts(); } });
                recentPagNav.appendChild(prevBtn);
                var from = Math.max(1, recentRegCurrentPage - 2);
                var to = Math.min(totalRecentPages, recentRegCurrentPage + 2);
                for (var p = from; p <= to; p++) {
                  var btn = document.createElement('button');
                  btn.type = 'button';
                  btn.className = 'admin-recent-pagination__btn' + (p === recentRegCurrentPage ? ' active' : '');
                  btn.textContent = p;
                  (function(page) { btn.addEventListener('click', function() { recentRegCurrentPage = page; updateOverviewCharts(); }); })(p);
                  recentPagNav.appendChild(btn);
                }
                var nextBtn = document.createElement('button');
                nextBtn.type = 'button';
                nextBtn.className = 'admin-recent-pagination__btn';
                nextBtn.textContent = 'Next';
                nextBtn.disabled = recentRegCurrentPage >= totalRecentPages;
                nextBtn.addEventListener('click', function() { if (recentRegCurrentPage < totalRecentPages) { recentRegCurrentPage++; updateOverviewCharts(); } });
                recentPagNav.appendChild(nextBtn);
              }
            }
          }
        }

        if (typeof Chart !== 'undefined') {
          var canvasVal = document.getElementById('chart-validation');
          if (canvasVal) {
            if (chartValidation) chartValidation.destroy();
            chartValidation = new Chart(canvasVal.getContext('2d'), {
              type: 'doughnut',
              data: {
                labels: ['Validated', 'Pending'],
                datasets: [{ data: [validated, pending], backgroundColor: ['#0d9488', '#94a3b8'], borderWidth: 0 }]
              },
              options: { responsive: true, maintainAspectRatio: false, cutout: '65%', plugins: { legend: { position: 'bottom' } } }
            });
          }
          var canvasReg = document.getElementById('chart-registrations');
          if (canvasReg) {
            var byDay = {};
            emails.forEach(function(e) {
              var at = users[e].registeredAt;
              if (!at) return;
              var key = at.slice(0, 10);
              byDay[key] = (byDay[key] || 0) + 1;
            });
            var sortedDays = Object.keys(byDay).sort();
            var last7 = sortedDays.slice(-7);
            if (last7.length === 0) last7 = [new Date().toISOString().slice(0, 10)];
            if (chartRegistrations) chartRegistrations.destroy();
            chartRegistrations = new Chart(canvasReg.getContext('2d'), {
              type: 'bar',
              data: {
                labels: last7.map(function(d) { return new Date(d).toLocaleDateString(undefined, { month: 'short', day: 'numeric' }); }),
                datasets: [{ label: 'Registrations', data: last7.map(function(d) { return byDay[d] || 0; }), backgroundColor: 'rgba(13,148,136,0.7)', borderRadius: 4 }]
              },
              options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, ticks: { stepSize: 1 } } }, plugins: { legend: { display: false } } }
            });
          }
          var occ = {};
          emails.forEach(function(e) { var o = users[e].occupation || 'Not set'; occ[o] = (occ[o] || 0) + 1; });
          var canvasOcc = document.getElementById('chart-occupation');
          if (canvasOcc) {
            if (chartOccupation) chartOccupation.destroy();
            chartOccupation = new Chart(canvasOcc.getContext('2d'), {
              type: 'doughnut',
              data: {
                labels: Object.keys(occ),
                datasets: [{ data: Object.values(occ), backgroundColor: ['#0d9488', '#6366f1', '#94a3b8', '#f59e0b', '#ec4899'], borderWidth: 0 }]
              },
              options: { responsive: true, maintainAspectRatio: false, cutout: '65%', plugins: { legend: { position: 'bottom' } } }
            });
          }
          var c = getActivityCounts(users);
          var stepsLabels = ['0 tasks', '1 task', '2 tasks', '3 tasks', '4 tasks'];
          var stepsData = [c.tasks0, c.tasks1, c.tasks2, c.tasks3, c.tasks4];
          var canvasSteps = document.getElementById('chart-steps');
          if (canvasSteps) {
            if (chartSteps) chartSteps.destroy();
            chartSteps = new Chart(canvasSteps.getContext('2d'), {
              type: 'bar',
              data: {
                labels: stepsLabels,
                datasets: [{
                  label: 'Users',
                  data: stepsData,
                  backgroundColor: ['#e2e8f0', '#94a3b8', '#64748b', '#475569', '#0d9488'],
                  borderRadius: 6,
                  borderSkipped: false
                }]
              },
              options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                  x: { beginAtZero: true, ticks: { stepSize: 1 }, grid: { color: 'rgba(0,0,0,0.06)' } },
                  y: { grid: { display: false } }
                },
                plugins: { legend: { display: false }, tooltip: { callbacks: { label: function(ctx) { return ctx.raw + ' user' + (ctx.raw === 1 ? '' : 's'); } } } }
              }
            });
          }
        }
      }

      function updateActivityCharts() {
        var users = getUsers();
        var emails = Object.keys(users);
        var c = getActivityCounts(users);
        var withActivity = 0;
        emails.forEach(function(email) { if (getUserActivity(email) !== 'â€”') withActivity++; });
        var totalUsers = emails.length;
        var partial = Math.max(0, withActivity - c.tasks4);
        var quizRate = totalUsers ? Math.round((c.quizDone / totalUsers) * 100) : 0;
        var quizEl = document.getElementById('activity-kpi-quiz');
        var fullEl = document.getElementById('activity-kpi-full');
        var withEl = document.getElementById('activity-kpi-with');
        var totalEl = document.getElementById('activity-kpi-total');
        var partialEl = document.getElementById('activity-kpi-partial');
        var quizRateEl = document.getElementById('activity-kpi-quiz-rate');
        if (quizEl) quizEl.textContent = c.quizDone;
        if (fullEl) fullEl.textContent = c.tasks4;
        if (withEl) withEl.textContent = withActivity;
        if (totalEl) totalEl.textContent = totalUsers;
        if (partialEl) partialEl.textContent = partial;
        if (quizRateEl) quizRateEl.textContent = quizRate + '%';

        var activityStatGrid = document.getElementById('activity-stat-grid');
        if (activityStatGrid) {
          var activityStats = [
            { strong: String(c.quizDone), span: 'Quiz completed', icon: 'fa-clipboard-check', theme: 'teal' },
            { strong: String(c.tasks4), span: 'All 4 tasks done', icon: 'fa-tasks', theme: 'violet' },
            { strong: String(partial), span: 'Partial progress', icon: 'fa-clock', theme: 'amber' }
          ];
          activityStatGrid.innerHTML = activityStats.map(function(s) {
            return '<div class="admin-analysis-stat-item admin-analysis-stat-item--' + s.theme + '">' +
              '<div class="admin-analysis-stat-item__icon"><i class="fas ' + s.icon + '"></i></div>' +
              '<div class="admin-analysis-stat-item__body"><strong>' + s.strong + '</strong><span>' + s.span + '</span></div></div>';
          }).join('');
        }

        var chartData = getActivityChartData(users);
        if (typeof Chart !== 'undefined') {
          var canvasAct = document.getElementById('chart-activity');
          if (canvasAct) {
            if (chartActivity) chartActivity.destroy();
            var taskLabels = (chartData.labels[0] === 'No data') ? ['0/4 tasks', '1/4 tasks', '2/4 tasks', '3/4 tasks', '4/4 tasks'] : chartData.labels;
            var taskData = (chartData.labels[0] === 'No data') ? [0, 0, 0, 0, 0] : chartData.data;
            var hasAny = taskData.some(function(n) { return n > 0; });
            var taskColors = hasAny ? ['#94a3b8', '#64748b', '#3b82f6', '#8b5cf6', '#10b981'] : ['#e2e8f0', '#e2e8f0', '#e2e8f0', '#e2e8f0', '#e2e8f0'];
            chartActivity = new Chart(canvasAct.getContext('2d'), {
              type: 'bar',
              data: {
                labels: taskLabels,
                datasets: [{
                  label: 'Users',
                  data: taskData,
                  backgroundColor: taskColors,
                  borderRadius: 8,
                  borderSkipped: false
                }]
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                  y: { beginAtZero: true, ticks: { stepSize: 1 }, grid: { color: 'rgba(0,0,0,0.06)' } },
                  x: { grid: { display: false } }
                },
                plugins: { legend: { display: false } }
              }
            });
          }
        }

        var filterEl = document.getElementById('activity-filter');
        var perPageEl = document.getElementById('activity-per-page');
        if (filterEl) activityFilter = filterEl.value;
        if (perPageEl) activityPerPage = Math.max(5, Math.min(50, parseInt(perPageEl.value, 10) || 10));

        var items = [];
        emails.forEach(function(email) {
          var act = getUserActivity(email);
          if (!act || act === 'â€”') return;
          var u = users[email];
          var hasQuiz = userHasQuiz(email);
          var taskCount = getCompletedTaskCount(email);
          var validated = !!u.validated && hasQuiz;
          if (activityFilter === 'quiz' && !hasQuiz) return;
          if (activityFilter === 'tasks' && taskCount < 1) return;
          if (activityFilter === 'full' && taskCount !== 4) return;
          items.push({
            email: email,
            name: (u.name || 'User').trim() || 'User',
            activity: act,
            validated: validated
          });
        });
        items.sort(function(a, b) { return (a.name || '').localeCompare(b.name || ''); });

        var tbody = document.getElementById('activity-summary-body');
        var emptyEl = document.getElementById('activity-empty');
        var paginationEl = document.getElementById('activity-pagination');
        var paginationInfo = document.getElementById('activity-pagination-info');
        var paginationNav = document.getElementById('activity-pagination-nav');
        var summaryCountEl = document.getElementById('activity-summary-count');

        if (!tbody || !emptyEl) return;

        if (summaryCountEl) summaryCountEl.textContent = items.length + ' user' + (items.length === 1 ? '' : 's');

        if (items.length === 0) {
          tbody.innerHTML = '';
          emptyEl.style.display = 'block';
          if (paginationEl) paginationEl.style.display = 'none';
          return;
        }
        emptyEl.style.display = 'none';

        var totalPages = Math.max(1, Math.ceil(items.length / activityPerPage));
        if (activityCurrentPage > totalPages) activityCurrentPage = totalPages;
        if (activityCurrentPage < 1) activityCurrentPage = 1;
        var start = (activityCurrentPage - 1) * activityPerPage;
        var pageItems = items.slice(start, start + activityPerPage);

        function initial(name) { return ((name || 'U').trim().charAt(0) || 'U').toUpperCase(); }
        tbody.innerHTML = pageItems.map(function(x) {
          var init = initial(x.name);
          var statusBadge = x.validated ? '<span class="admin-badge admin-badge--validated">Validated</span>' : '<span class="admin-badge admin-badge--pending">Pending</span>';
          return '<tr><td class="admin-table__cell-avatar"><span class="admin-activity-avatar">' + escapeHtml(init) + '</span></td><td>' + escapeHtml(x.name) + '</td><td>' + escapeHtml(x.email) + '</td><td class="admin-activity">' + escapeHtml(x.activity) + '</td><td>' + statusBadge + '</td></tr>';
        }).join('');

        if (paginationEl && paginationInfo && paginationNav) {
          if (totalPages <= 1) {
            paginationEl.style.display = 'none';
          } else {
            paginationEl.style.display = 'flex';
            var end = Math.min(start + activityPerPage, items.length);
            paginationInfo.textContent = 'Showing ' + (start + 1) + 'â€“' + end + ' of ' + items.length;
            paginationNav.innerHTML = '';
            var prevBtn = document.createElement('button');
            prevBtn.type = 'button';
            prevBtn.className = 'admin-pagination__btn';
            prevBtn.textContent = 'Prev';
            prevBtn.disabled = activityCurrentPage <= 1;
            prevBtn.addEventListener('click', function() { if (activityCurrentPage > 1) { activityCurrentPage--; updateActivityCharts(); } });
            paginationNav.appendChild(prevBtn);
            var from = Math.max(1, activityCurrentPage - 2);
            var to = Math.min(totalPages, activityCurrentPage + 2);
            for (var p = from; p <= to; p++) {
              var btn = document.createElement('button');
              btn.type = 'button';
              btn.className = 'admin-pagination__btn' + (p === activityCurrentPage ? ' active' : '');
              btn.textContent = p;
              (function(page) { btn.addEventListener('click', function() { activityCurrentPage = page; updateActivityCharts(); }); })(p);
              paginationNav.appendChild(btn);
            }
            var nextBtn = document.createElement('button');
            nextBtn.type = 'button';
            nextBtn.className = 'admin-pagination__btn';
            nextBtn.textContent = 'Next';
            nextBtn.disabled = activityCurrentPage >= totalPages;
            nextBtn.addEventListener('click', function() { if (activityCurrentPage < totalPages) { activityCurrentPage++; updateActivityCharts(); } });
            paginationNav.appendChild(nextBtn);
          }
        }
      }

      function updateAnalysisCharts() {
        var users = getUsers();
        var emails = Object.keys(users);
        var total = emails.length;
        var validated = emails.filter(function(e) { return !!users[e].validated && userHasQuiz(e); }).length;
        var pending = total - validated;
        var c = getActivityCounts(users);
        var quizDone = c.quizDone || 0;
        var fullDone = c.tasks4 || 0;
        var rate = total ? Math.round((validated / total) * 100) : 0;
        var quizRate = total ? Math.round((quizDone / total) * 100) : 0;
        var fullRate = total ? Math.round((fullDone / total) * 100) : 0;
        var now = new Date();
        var sevenDaysAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
        var last7Count = emails.filter(function(e) { var at = users[e].registeredAt; return at && new Date(at) >= sevenDaysAgo; }).length;
        function dayKey(d) { return d.getFullYear() + '-' + String(d.getMonth() + 1).padStart(2, '0') + '-' + String(d.getDate()).padStart(2, '0'); }
        var regByDay = [];
        var dayLabels = [];
        for (var d = 6; d >= 0; d--) {
          var date = new Date(now);
          date.setDate(date.getDate() - d);
          date.setHours(0, 0, 0, 0);
          var key = dayKey(date);
          dayLabels.push(date.toLocaleDateString(undefined, { weekday: 'short', day: 'numeric' }));
          var count = emails.filter(function(e) {
            var at = users[e].registeredAt;
            if (!at) return false;
            var uDate = new Date(at);
            uDate.setHours(0, 0, 0, 0);
            return dayKey(uDate) === key;
          }).length;
          regByDay.push(count);
        }

        var elTotal = document.getElementById('analysis-total');
        var elVal = document.getElementById('analysis-validated-count');
        var elPen = document.getElementById('analysis-pending-count');
        var elQuizC = document.getElementById('analysis-quiz-count');
        var elFullC = document.getElementById('analysis-full-count');
        var elLast7 = document.getElementById('analysis-last7');
        if (elTotal) elTotal.textContent = total;
        if (elVal) elVal.textContent = validated;
        if (elPen) elPen.textContent = pending;
        if (elQuizC) elQuizC.textContent = quizDone;
        if (elFullC) elFullC.textContent = fullDone;
        if (elLast7) elLast7.textContent = last7Count;

        var barOpt = { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.06)' } }, x: { grid: { display: false } } }, plugins: { legend: { display: false } } };
        if (typeof Chart !== 'undefined') {
          var canvasVal = document.getElementById('chart-analysis-validation');
          if (canvasVal) {
            if (chartAnalysisValidation) chartAnalysisValidation.destroy();
            var valData = total > 0 ? [validated, pending] : [0, 0];
            var valLabels = ['Validated', 'Pending'];
            chartAnalysisValidation = new Chart(canvasVal.getContext('2d'), {
              type: 'bar',
              data: {
                labels: valLabels,
                datasets: [{
                  label: 'Users',
                  data: valData,
                  backgroundColor: ['#10b981', '#f59e0b'],
                  borderRadius: 8,
                  borderSkipped: false
                }]
              },
              options: barOpt
            });
          }
          var canvasQuiz = document.getElementById('chart-analysis-quiz');
          if (canvasQuiz) {
            if (chartAnalysisQuiz) chartAnalysisQuiz.destroy();
            var quizNot = total - quizDone;
            chartAnalysisQuiz = new Chart(canvasQuiz.getContext('2d'), {
              type: 'bar',
              data: {
                labels: ['Quiz done', 'Not yet'],
                datasets: [{
                  label: 'Users',
                  data: total > 0 ? [quizDone, quizNot] : [0, 0],
                  backgroundColor: ['#14b8a6', '#94a3b8'],
                  borderRadius: 8,
                  borderSkipped: false
                }]
              },
              options: barOpt
            });
          }
          var canvasRates = document.getElementById('chart-analysis-rates');
          if (canvasRates) {
            if (chartAnalysisRates) chartAnalysisRates.destroy();
            chartAnalysisRates = new Chart(canvasRates.getContext('2d'), {
              type: 'bar',
              data: {
                labels: ['Validation %', 'Quiz %', 'Full 4/4 %'],
                datasets: [{
                  label: 'Rate',
                  data: [rate, quizRate, fullRate],
                  backgroundColor: ['#3b82f6', '#8b5cf6', '#06b6d4'],
                  borderRadius: 8,
                  borderSkipped: false
                }]
              },
              options: barOpt
            });
          }
          var canvasTasks = document.getElementById('chart-analysis-tasks');
          if (canvasTasks) {
            if (chartAnalysisTasks) chartAnalysisTasks.destroy();
            var taskLabels = ['0 tasks', '1 task', '2 tasks', '3 tasks', '4 tasks'];
            var taskData = [c.tasks0 || 0, c.tasks1 || 0, c.tasks2 || 0, c.tasks3 || 0, c.tasks4 || 0];
            var hasAny = taskData.some(function(n) { return n > 0; });
            if (!hasAny) taskData = [0, 0, 0, 0, 0];
            chartAnalysisTasks = new Chart(canvasTasks.getContext('2d'), {
              type: 'bar',
              data: {
                labels: taskLabels,
                datasets: [{
                  label: 'Users',
                  data: taskData,
                  backgroundColor: ['#94a3b8', '#64748b', '#3b82f6', '#8b5cf6', '#10b981'],
                  borderRadius: 8,
                  borderSkipped: false
                }]
              },
              options: { responsive: true, maintainAspectRatio: false, indexAxis: 'y', scales: { x: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.06)' } }, y: { grid: { display: false } } }, plugins: { legend: { display: false } } }
            });
          }
          var canvasReg = document.getElementById('chart-analysis-registrations');
          if (canvasReg) {
            if (chartAnalysisRegistrations) chartAnalysisRegistrations.destroy();
            chartAnalysisRegistrations = new Chart(canvasReg.getContext('2d'), {
              type: 'line',
              data: {
                labels: dayLabels,
                datasets: [{
                  label: 'Registrations',
                  data: regByDay,
                  borderColor: '#ec4899',
                  backgroundColor: 'rgba(236, 72, 153, 0.15)',
                  fill: true,
                  tension: 0.35,
                  pointBackgroundColor: '#ec4899',
                  pointRadius: 4
                }]
              },
              options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, ticks: { stepSize: 1 }, grid: { color: 'rgba(0,0,0,0.06)' } }, x: { grid: { display: false } } }, plugins: { legend: { display: false } } }
            });
          }
        }

        var statGrid = document.getElementById('analysis-stat-grid');
        if (statGrid) {
          var stats = [
            { strong: rate + '%', span: 'Validation rate', icon: 'fa-check-circle', theme: 'green' },
            { strong: quizRate + '%', span: 'Quiz completion', icon: 'fa-clipboard-check', theme: 'blue' },
            { strong: fullRate + '%', span: 'Full 4/4 rate', icon: 'fa-tasks', theme: 'violet' },
            { strong: (total ? Math.round((pending / total) * 100) : 0) + '%', span: 'Pending share', icon: 'fa-clock', theme: 'amber' }
          ];
          statGrid.innerHTML = stats.map(function(s) {
            return '<div class="admin-analysis-stat-item admin-analysis-stat-item--' + s.theme + '">' +
              '<div class="admin-analysis-stat-item__icon"><i class="fas ' + s.icon + '"></i></div>' +
              '<div class="admin-analysis-stat-item__body"><strong>' + s.strong + '</strong><span>' + s.span + '</span></div></div>';
          }).join('');
        }

        var insightsEl = document.getElementById('analysis-insights');
        if (insightsEl) {
          var items = [];
          if (total > 0) items.push('<li><i class="fas fa-users"></i> <strong>' + total + '</strong> registered users in total</li>');
          if (validated > 0) items.push('<li><i class="fas fa-check-circle"></i> <strong>' + validated + '</strong> validated (' + rate + '% of total)</li>');
          if (pending > 0) items.push('<li><i class="fas fa-clock"></i> <strong>' + pending + '</strong> pending validation</li>');
          if (quizDone > 0) items.push('<li><i class="fas fa-clipboard-check"></i> <strong>' + quizDone + '</strong> completed the quiz (' + quizRate + '%)</li>');
          if (fullDone > 0) items.push('<li><i class="fas fa-tasks"></i> <strong>' + fullDone + '</strong> completed all 4 tasks (' + fullRate + '%)</li>');
          if (last7Count > 0) items.push('<li><i class="fas fa-calendar-plus"></i> <strong>' + last7Count + '</strong> new users in the last 7 days</li>');
          var note = '';
          if (total === 0) note = 'No users yet. Data will appear as users register and complete the quiz and tasks.';
          else if (pending > 0 && rate < 100) note = 'Tip: Use the Users page to validate pending users who have completed the quiz.';
          else if (quizRate < 100) note = 'Encourage users to complete the exit plan quiz to improve validation rates.';
          else note = 'Keep validating new users from the Users page to maintain your pipeline.';
          items.push('<li class="admin-insight-note">' + note + '</li>');
          insightsEl.innerHTML = items.length ? items.join('') : '<li style="color: var(--admin-text-muted);">No data yet.</li>';
        }
      }

      function renderProfilePage() {
        var username = sessionStorage.getItem(ADMIN_SESSION_KEY) || 'admin';
        var name = sessionStorage.getItem(ADMIN_NAME_KEY) || 'Administrator';
        var role = sessionStorage.getItem(ADMIN_ROLE_KEY) || 'Full access';
        var admin = getAdmins().find(function(a) { return (a.username || '').toLowerCase() === username.toLowerCase(); });
        if (admin) { name = admin.name || name; role = admin.role || role; }
        var avatarEl = document.getElementById('profile-hero-avatar');
        var nameEl = document.getElementById('profile-hero-name');
        var roleEl = document.getElementById('profile-hero-role');
        var disp = document.getElementById('profile-username-display');
        if (avatarEl) avatarEl.textContent = (name.charAt(0) || 'A').toUpperCase();
        if (nameEl) nameEl.textContent = name;
        if (roleEl) roleEl.textContent = role;
        if (disp) disp.textContent = '@' + username;
        var nameIn = document.getElementById('profile-name');
        var userIn = document.getElementById('profile-username');
        if (nameIn) nameIn.value = name;
        if (userIn) userIn.value = username;
        document.getElementById('profile-current-pw').value = '';
        document.getElementById('profile-new-pw').value = '';
      }
      function renderTeamAdmins() {
        var admins = getAdmins();
        var tbody = document.getElementById('team-admins-body');
        var emptyEl = document.getElementById('team-empty');
        var countEl = document.getElementById('team-admins-count');
        var currentUser = sessionStorage.getItem(ADMIN_SESSION_KEY) || '';
        if (!tbody) return;
        if (countEl) countEl.textContent = admins.length + ' admin' + (admins.length === 1 ? '' : 's');
        if (admins.length === 0) {
          tbody.innerHTML = '';
          if (emptyEl) emptyEl.style.display = 'block';
          return;
        }
        if (emptyEl) emptyEl.style.display = 'none';
        tbody.innerHTML = admins.map(function(a) {
          var isSelf = (a.username || '').toLowerCase() === currentUser.toLowerCase();
          var canRemove = !isViewOnlyAdmin() && admins.length > 1 && !isSelf;
          var delBtn = canRemove
            ? '<button type="button" class="admin-btn admin-btn--delete admin-team-del" data-username="' + escapeHtml(a.username) + '"><i class="fas fa-trash"></i> Remove</button>'
            : (isSelf ? 'You' : '');
          return '<tr><td>' + escapeHtml(a.name || a.username) + '</td><td>' + escapeHtml(a.username) + '</td><td>' + escapeHtml(a.role || 'Full access') + '</td><td>' + delBtn + '</td></tr>';
        }).join('');
        tbody.querySelectorAll('.admin-team-del').forEach(function(btn) {
          btn.addEventListener('click', function() {
            var username = this.getAttribute('data-username');
            if (!username || !confirm('Remove this administrator? They will no longer be able to sign in.')) return;
            var admins = getAdmins().filter(function(a) { return (a.username || '').toLowerCase() !== username.toLowerCase(); });
            saveAdmins(admins);
            renderTeamAdmins();
            alert('Administrator removed.');
          });
        });
      }
      function populateSettingsForm() {
        var s = getAdminSettings();
        var v = document.getElementById('setting-default-view');
        var d = document.getElementById('setting-date-format');
        var p = document.getElementById('setting-users-per-page');
        var r = document.getElementById('setting-recent-per-page');
        var t = document.getElementById('setting-theme');
        var td = document.getElementById('setting-table-density');
        if (v) v.value = s.defaultView;
        if (d) d.value = s.dateFormat;
        if (p) p.value = String(s.usersPerPage);
        if (r) r.value = String(s.recentRegPerPage);
        if (t) t.value = s.theme;
        if (td) td.value = s.tableDensity;
      }

      function isViewOnlyAdmin() {
        var role = (sessionStorage.getItem(ADMIN_ROLE_KEY) || 'Full access').toLowerCase();
        return role.indexOf('view only') !== -1;
      }
      function applyViewOnlyRestrictions() {
        if (isViewOnlyAdmin()) document.body.classList.add('admin-role-viewonly');
        else document.body.classList.remove('admin-role-viewonly');
      }
      function updateTopbarProfile() {
        var name = sessionStorage.getItem(ADMIN_NAME_KEY) || 'Administrator';
        var role = sessionStorage.getItem(ADMIN_ROLE_KEY) || 'Full access';
        var initial = (name.charAt(0) || 'A').toUpperCase();
        var avatarEl = document.getElementById('admin-topbar-avatar');
        var nameEl = document.getElementById('admin-topbar-name');
        var roleEl = document.getElementById('admin-topbar-role');
        if (avatarEl) avatarEl.textContent = initial;
        if (nameEl) nameEl.textContent = name;
        if (roleEl) roleEl.textContent = role;
        applyViewOnlyRestrictions();
      }

      function switchView(viewId) {
        document.querySelectorAll('.admin-view').forEach(function(v) { v.classList.remove('is-active'); });
        document.querySelectorAll('.admin-sidebar__link[data-view]').forEach(function(l) { l.classList.toggle('active', l.getAttribute('data-view') === viewId); });
        var viewEl = document.getElementById('view-' + viewId);
        if (viewEl) viewEl.classList.add('is-active');
        var titles = { overview: 'Overview', users: 'Users', activity: 'Activity', analysis: 'Analysis', profile: 'My profile', team: 'Team', settings: 'Settings' };
        var breads = { overview: 'Admin \u00bb Dashboard', users: 'Admin \u00bb Registered users', activity: 'Admin \u00bb User activity', analysis: 'Admin \u00bb Analysis', profile: 'Admin \u00bb Profile', team: 'Admin \u00bb Team', settings: 'Admin \u00bb Settings' };
        var t = document.getElementById('admin-page-title');
        var b = document.getElementById('admin-breadcrumb');
        if (t) t.textContent = titles[viewId] || viewId;
        if (b) b.textContent = breads[viewId] || '';
        if (viewId === 'overview') updateOverviewCharts();
        if (viewId === 'activity') updateActivityCharts();
        if (viewId === 'analysis') updateAnalysisCharts();
        if (viewId === 'profile') renderProfilePage();
        if (viewId === 'team') renderTeamAdmins();
        if (viewId === 'settings') populateSettingsForm();
      }

      function closeMobileMenu() {
        document.body.classList.remove('admin-menu-open');
      }
      function openMobileMenu() {
        document.body.classList.add('admin-menu-open');
      }
      function toggleMobileMenu() {
        document.body.classList.toggle('admin-menu-open');
      }
      var burger = document.getElementById('admin-burger');
      var backdrop = document.getElementById('admin-sidebar-backdrop');
      var sidebarClose = document.getElementById('admin-sidebar-close');
      if (burger) burger.addEventListener('click', function(e) { e.preventDefault(); toggleMobileMenu(); });
      if (backdrop) backdrop.addEventListener('click', closeMobileMenu);
      if (sidebarClose) sidebarClose.addEventListener('click', closeMobileMenu);

      document.querySelectorAll('.admin-sidebar__link[data-view]').forEach(function(link) {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          var view = this.getAttribute('data-view');
          if (view) {
            switchView(view);
            closeMobileMenu();
          }
        });
      });

      var overviewViewUsers = document.getElementById('overview-view-users');
      if (overviewViewUsers) {
        overviewViewUsers.addEventListener('click', function(e) { e.preventDefault(); switchView('users'); });
      }
      document.querySelectorAll('.admin-kpi-card__viewall[data-view]').forEach(function(link) {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          var view = this.getAttribute('data-view');
          if (view) switchView(view);
        });
      });

      var usersFilterEl = document.getElementById('admin-users-filter');
      if (usersFilterEl) usersFilterEl.addEventListener('change', function() { usersCurrentPage = 1; renderUsers(); });

      var activityFilterEl = document.getElementById('activity-filter');
      if (activityFilterEl) activityFilterEl.addEventListener('change', function() { activityCurrentPage = 1; updateActivityCharts(); });
      var activityPerPageEl = document.getElementById('activity-per-page');
      if (activityPerPageEl) activityPerPageEl.addEventListener('change', function() { activityCurrentPage = 1; updateActivityCharts(); });

      document.getElementById('admin-bulk-validate').addEventListener('click', function() {
        if (isViewOnlyAdmin()) return;
        var users = getUsers();
        var toValidate = Object.keys(selectedUserEmails).filter(function(email) { return users[email] && !users[email].validated; });
        if (toValidate.length === 0) { alert('No pending users in selection.'); return; }
        toValidate.forEach(function(email) { users[email].validated = true; });
        saveUsers(users);
        selectedUserEmails = {};
        renderUsers();
        alert(toValidate.length + ' user(s) validated.');
      });
      document.getElementById('admin-bulk-edit').addEventListener('click', function() {
        if (isViewOnlyAdmin()) return;
        var sel = Object.keys(selectedUserEmails);
        if (sel.length === 0) { alert('Select one user to edit.'); return; }
        if (sel.length > 1) { alert('Select only one user to edit.'); return; }
        var email = sel[0];
        var users = getUsers();
        var u = users[email];
        if (!u) return;
        document.getElementById('edit-user-email-original').value = email;
        document.getElementById('edit-name').value = u.name || '';
        document.getElementById('edit-email').value = u.email || email;
        document.getElementById('edit-phone').value = u.phone || '';
        document.getElementById('edit-occupation').value = u.occupation || '';
        document.getElementById('edit-address').value = u.address || '';
        document.getElementById('edit-modal').classList.add('is-open');
        document.getElementById('edit-modal').setAttribute('aria-hidden', 'false');
      });
      document.getElementById('admin-bulk-delete').addEventListener('click', function() {
        if (isViewOnlyAdmin()) return;
        var toDelete = Object.keys(selectedUserEmails);
        if (toDelete.length === 0) return;
        if (!confirm('Delete ' + toDelete.length + ' user(s) and all their data? This cannot be undone.')) return;
        var users = getUsers();
        toDelete.forEach(function(email) { delete users[email]; deleteUserData(email); });
        saveUsers(users);
        selectedUserEmails = {};
        renderUsers();
        alert('User(s) deleted.');
      });
      document.getElementById('admin-bulk-clear').addEventListener('click', function() {
        selectedUserEmails = {};
        updateUsersBulkBar();
        renderUsers();
      });

      var editModal = document.getElementById('edit-modal');
      var editForm = document.getElementById('edit-user-form');

      document.getElementById('edit-modal-close').addEventListener('click', closeEditModal);
      document.getElementById('edit-cancel').addEventListener('click', closeEditModal);
      editModal.addEventListener('click', function(e) {
        if (e.target === editModal) closeEditModal();
      });

      function closeEditModal() {
        editModal.classList.remove('is-open');
        editModal.setAttribute('aria-hidden', 'true');
      }

      editForm.addEventListener('submit', function(e) {
        e.preventDefault();
        if (isViewOnlyAdmin()) { closeEditModal(); return; }
        var originalEmail = document.getElementById('edit-user-email-original').value.trim().toLowerCase();
        var name = document.getElementById('edit-name').value.trim() || 'User';
        var newEmail = document.getElementById('edit-email').value.trim().toLowerCase();
        var phone = document.getElementById('edit-phone').value.trim();
        var occupation = document.getElementById('edit-occupation').value.trim();
        var address = document.getElementById('edit-address').value.trim();

        var users = getUsers();
        if (!users[originalEmail]) { closeEditModal(); return; }

        if (newEmail !== originalEmail && users[newEmail]) {
          alert('This email is already used by another account.');
          return;
        }

        if (newEmail !== originalEmail) {
          migrateUserData(originalEmail, newEmail);
          users[newEmail] = {
            email: newEmail, password: users[originalEmail].password, name: name, phone: phone,
            address: address, occupation: occupation, validated: !!users[originalEmail].validated,
            registeredAt: users[originalEmail].registeredAt || new Date().toISOString()
          };
          delete users[originalEmail];
          deleteUserData(originalEmail);
        } else {
          users[originalEmail].name = name;
          users[originalEmail].phone = phone;
          users[originalEmail].occupation = occupation;
          users[originalEmail].address = address;
        }
        saveUsers(users);
        closeEditModal();
        renderUsers();
        if (typeof showToast === 'function') showToast('User updated.', 'success');
        else alert('User updated.');
      });

      document.getElementById('profile-form').addEventListener('submit', function(e) {
        e.preventDefault();
        var currentUser = sessionStorage.getItem(ADMIN_SESSION_KEY) || '';
        var newName = (document.getElementById('profile-name').value || '').trim() || 'Administrator';
        var newUsername = (document.getElementById('profile-username').value || '').trim().toLowerCase();
        var currentPw = document.getElementById('profile-current-pw').value;
        var newPw = document.getElementById('profile-new-pw').value;
        if (!newUsername) { alert('Username is required.'); return; }
        var admins = getAdmins();
        var idx = admins.findIndex(function(a) { return (a.username || '').toLowerCase() === currentUser.toLowerCase(); });
        if (idx < 0) { alert('Account not found.'); return; }
        if (admins.some(function(a, i) { return i !== idx && (a.username || '').toLowerCase() === newUsername; })) { alert('Username already in use.'); return; }
        admins[idx].name = newName;
        admins[idx].username = newUsername;
        if (newPw && newPw.length >= 6) {
          if (!currentPw || admins[idx].password !== currentPw) { alert('Current password is incorrect.'); return; }
          admins[idx].password = newPw;
        }
        saveAdmins(admins);
        sessionStorage.setItem(ADMIN_SESSION_KEY, newUsername);
        sessionStorage.setItem(ADMIN_NAME_KEY, newName);
        document.getElementById('profile-current-pw').value = '';
        document.getElementById('profile-new-pw').value = '';
        document.getElementById('profile-username-display').textContent = '@' + newUsername;
        updateTopbarProfile();
        alert('Profile updated.');
      });

      document.getElementById('team-add-form').addEventListener('submit', function(e) {
        e.preventDefault();
        if (isViewOnlyAdmin()) return;
        var name = (document.getElementById('team-add-name').value || '').trim() || 'Admin';
        var username = (document.getElementById('team-add-username').value || '').trim().toLowerCase();
        var password = document.getElementById('team-add-password').value;
        var role = document.getElementById('team-add-role').value;
        if (!username) { alert('Username is required.'); return; }
        if (password.length < 6) { alert('Password must be at least 6 characters.'); return; }
        var admins = getAdmins();
        if (admins.some(function(a) { return (a.username || '').toLowerCase() === username; })) { alert('Username already in use.'); return; }
        admins.push({ username: username, password: password, name: name, role: role });
        saveAdmins(admins);
        document.getElementById('team-add-name').value = '';
        document.getElementById('team-add-username').value = '';
        document.getElementById('team-add-password').value = '';
        document.getElementById('team-add-role').value = 'Full access';
        renderTeamAdmins();
        alert('Administrator added.');
      });

      document.getElementById('admin-settings-form').addEventListener('submit', function(e) {
        e.preventDefault();
        var settings = {
          defaultView: document.getElementById('setting-default-view').value,
          dateFormat: document.getElementById('setting-date-format').value,
          usersPerPage: Math.max(5, Math.min(50, parseInt(document.getElementById('setting-users-per-page').value, 10) || 10)),
          recentRegPerPage: Math.max(5, Math.min(20, parseInt(document.getElementById('setting-recent-per-page').value, 10) || 5)),
          theme: document.getElementById('setting-theme').value,
          tableDensity: document.getElementById('setting-table-density').value
        };
        saveAdminSettings(settings);
        usersCurrentPage = 1;
        recentRegCurrentPage = 1;
        applyTheme();
        applyTableDensity();
        renderUsers();
        updateOverviewCharts();
        alert('Settings saved.');
      });

      document.getElementById('admin-logout').addEventListener('click', function() {
        sessionStorage.removeItem(ADMIN_SESSION_KEY);
        sessionStorage.removeItem(ADMIN_NAME_KEY);
        sessionStorage.removeItem(ADMIN_ROLE_KEY);
        window.location.href = 'admin.html';
      });

      (function initProfileDropdown() {
        var profileEl = document.getElementById('admin-topbar-profile');
        var dropdown = document.getElementById('admin-profile-dropdown');
        if (!profileEl || !dropdown) return;
        profileEl.addEventListener('click', function(e) {
          if (e.target.closest('.admin-topbar__profile-dropdown')) return;
          e.preventDefault();
          profileEl.classList.toggle('is-open');
          profileEl.setAttribute('aria-expanded', profileEl.classList.contains('is-open'));
        });
        dropdown.querySelectorAll('a[data-view]').forEach(function(a) {
          a.addEventListener('click', function(e) {
            e.preventDefault();
            var view = this.getAttribute('data-view');
            if (view) switchView(view);
            profileEl.classList.remove('is-open');
            profileEl.setAttribute('aria-expanded', 'false');
          });
        });
        document.addEventListener('click', function(e) {
          if (!profileEl.contains(e.target)) {
            profileEl.classList.remove('is-open');
            profileEl.setAttribute('aria-expanded', 'false');
          }
        });
      })();

      updateTopbarProfile();
      applyTheme();
      applyTableDensity();
      seedUsersIfEmpty();
      renderUsers();
      var defaultView = getAdminSettings().defaultView;
      if (defaultView && defaultView !== 'overview') switchView(defaultView);
      if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)')) {
        window.matchMedia('(prefers-color-scheme: dark)').addListener(function() { if (getAdminSettings().theme === 'system') applyTheme(); });
      }
    })();
  </script>
</body>
</html>
